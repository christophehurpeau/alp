{"version":3,"file":"index-node14.mjs","sources":["../src/index.ts"],"sourcesContent":["import type { ApplicationInCreation } from 'alp-types';\n// eslint-disable-next-line node/no-extraneous-import\nimport type { Context } from 'koa';\nimport { defineLazyProperty } from 'object-properties';\n\ndeclare module 'alp-types' {\n  // eslint-disable-next-line @typescript-eslint/no-empty-interface\n  interface BaseContext {}\n  // eslint-disable-next-line @typescript-eslint/no-shadow\n  interface Context {\n    readonly firstAcceptedLanguage: string;\n    readonly language: string;\n  }\n}\n\nexport default function alpLanguage(app: ApplicationInCreation): void {\n  const config = app.context.config;\n  const availableLanguages: string[] = config.get('availableLanguages');\n  if (!availableLanguages) {\n    throw new Error('Missing config \"availableLanguages\"');\n  }\n\n  defineLazyProperty(app.context, 'language', function (this: Context): string {\n    return this.acceptsLanguages(availableLanguages) || availableLanguages[0];\n  });\n\n  defineLazyProperty(\n    app.context,\n    'firstAcceptedLanguage',\n    function (this: Context): string {\n      return this.acceptsLanguages()[0] || availableLanguages[0];\n    },\n  );\n}\n"],"names":["alpLanguage","app","config","context","availableLanguages","get","Error","defineLazyProperty","acceptsLanguages"],"mappings":";;AACA;AAce,SAASA,WAAT,CAAqBC,GAArB,EAAuD;AACpE,QAAMC,MAAM,GAAGD,GAAG,CAACE,OAAJ,CAAYD,MAA3B;AACA,QAAME,kBAA4B,GAAGF,MAAM,CAACG,GAAP,CAAW,oBAAX,CAArC;;AACA,MAAI,CAACD,kBAAL,EAAyB;AACvB,UAAM,IAAIE,KAAJ,CAAU,qCAAV,CAAN;AACD;;AAEDC,EAAAA,kBAAkB,CAACN,GAAG,CAACE,OAAL,EAAc,UAAd,EAA0B,YAAiC;AAC3E,WAAO,KAAKK,gBAAL,CAAsBJ,kBAAtB,KAA6CA,kBAAkB,CAAC,CAAD,CAAtE;AACD,GAFiB,CAAlB;AAIAG,EAAAA,kBAAkB,CAChBN,GAAG,CAACE,OADY,EAEhB,uBAFgB,EAGhB,YAAiC;AAC/B,WAAO,KAAKK,gBAAL,GAAwB,CAAxB,KAA8BJ,kBAAkB,CAAC,CAAD,CAAvD;AACD,GALe,CAAlB;AAOD;;;;"}