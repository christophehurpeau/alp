{"version":3,"sources":["../src/Manager.js"],"names":["MigrationsManager","constructor","store","findLastVersion","r","findValue","table","orderBy","desc","findOne","created","then","row","version","addMigrationDone","migration","insertOne"],"mappings":"IAAqBA,iB,GAAN,MAAwB;AACrCC,cAAYC,KAAZ,EAAmB;AACjB,SAAKA,KAAL,GAAaA,KAAb;AACD;;AAEDC,oBAAkB;AAChB,QAAI,KAAKD,KAAL,CAAWE,CAAf,EAAkB;AAChB,aAAO,KAAKF,KAAL,CAAWG,SAAX,CACL,SADK,EAEL,KAAKH,KAAL,CACGI,KADH,GAEGC,OAFH,CAEW,KAAKL,KAAL,CAAWE,CAAX,CAAaI,IAAb,CAAkB,SAAlB,CAFX,CAFK,CAAP;AAMD,KAPD,MAOO;AACL,aAAO,KAAKN,KAAL,CAAWO,OAAX,KAAuB,EAAEC,SAAS,CAAC,CAAZ,EAAvB,EACJC,IADI,CACCC,OAAOA,OAAOA,IAAIC,OADnB,CAAP;AAED;AACF;;AAEDC,mBAAiBC,SAAjB,EAA4B;AAC1B,WAAO,KAAKb,KAAL,CAAWc,SAAX,CAAqBD,SAArB,CAAP;AACD;AArBoC,C;SAAlBf,iB","file":"Manager.js","sourcesContent":["export default class MigrationsManager {\n  constructor(store) {\n    this.store = store;\n  }\n\n  findLastVersion() {\n    if (this.store.r) {\n      return this.store.findValue(\n        'version',\n        this.store\n          .table()\n          .orderBy(this.store.r.desc('version')),\n      );\n    } else {\n      return this.store.findOne({}, { created: -1 })\n        .then(row => row && row.version);\n    }\n  }\n\n  addMigrationDone(migration) {\n    return this.store.insertOne(migration);\n  }\n}\n"]}