{"version":3,"sources":["../src/Manager.js"],"names":["MigrationsManager","constructor","store","findLastVersion","r","findOne","table","orderBy","desc","getField","created","then","row","version","addMigrationDone","migration","insertOne"],"mappings":";;;;;AAAe,MAAMA,iBAAN,CAAwB;AACrCC,cAAYC,KAAZ,EAAmB;AACjB,SAAKA,KAAL,GAAaA,KAAb;AACD;;AAEDC,oBAAkB;AAChB,QAAI,KAAKD,KAAL,CAAWE,CAAf,EAAkB;AAChB,aAAO,KAAKF,KAAL,CAAWG,OAAX,CACL,KAAKH,KAAL,CACGI,KADH,GAEGC,OAFH,CAEW,KAAKL,KAAL,CAAWE,CAAX,CAAaI,IAAb,CAAkB,SAAlB,CAFX,EAGGC,QAHH,CAGY,SAHZ,CADK,CAAP;AAMD,KAPD,MAOO;AACL,aAAO,KAAKP,KAAL,CAAWG,OAAX,KAAuB,EAAEK,SAAS,CAAC,CAAZ,EAAvB,EACJC,IADI,CACCC,OAAOA,OAAOA,IAAIC,OADnB,CAAP;AAED;AACF;;AAEDC,mBAAiBC,SAAjB,EAA4B;AAC1B,WAAO,KAAKb,KAAL,CAAWc,SAAX,CAAqBD,SAArB,CAAP;AACD;AArBoC;kBAAlBf,iB","file":"Manager.js","sourcesContent":["export default class MigrationsManager {\n  constructor(store) {\n    this.store = store;\n  }\n\n  findLastVersion() {\n    if (this.store.r) {\n      return this.store.findOne(\n        this.store\n          .table()\n          .orderBy(this.store.r.desc('version'))\n          .getField('version'),\n      );\n    } else {\n      return this.store.findOne({}, { created: -1 })\n        .then(row => row && row.version);\n    }\n  }\n\n  addMigrationDone(migration) {\n    return this.store.insertOne(migration);\n  }\n}\n"]}