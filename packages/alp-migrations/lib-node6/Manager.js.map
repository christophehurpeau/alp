{"version":3,"sources":["../src/Manager.js"],"names":["MigrationsManager","constructor","store","findLastVersion","r","findOne","table","getField","created","then","row","version","addMigrationDone","migration","insertOne"],"mappings":";;;;;AAAe,MAAMA,iBAAN,CAAwB;AACrCC,cAAYC,KAAZ,EAAmB;AACjB,SAAKA,KAAL,GAAaA,KAAb;AACD;;AAEDC,oBAAkB;AAChB,QAAI,KAAKD,KAAL,CAAWE,CAAf,EAAkB;AAChB,aAAO,KAAKF,KAAL,CAAWG,OAAX,CACL,KAAKH,KAAL,CAAWI,KAAX,GAAmBC,QAAnB,CAA4B,SAA5B,CADK,CAAP;AAGD,KAJD,MAIO;AACL,aAAO,KAAKL,KAAL,CAAWG,OAAX,KAAuB,EAAEG,SAAS,CAAC,CAAZ,EAAvB,EACJC,IADI,CACCC,OAAOA,OAAOA,IAAIC,OADnB,CAAP;AAED;AACF;;AAEDC,mBAAiBC,SAAjB,EAA4B;AAC1B,WAAO,KAAKX,KAAL,CAAWY,SAAX,CAAqBD,SAArB,CAAP;AACD;AAlBoC;kBAAlBb,iB","file":"Manager.js","sourcesContent":["export default class MigrationsManager {\n  constructor(store) {\n    this.store = store;\n  }\n\n  findLastVersion() {\n    if (this.store.r) {\n      return this.store.findOne(\n        this.store.table().getField('version'),\n      );\n    } else {\n      return this.store.findOne({}, { created: -1 })\n        .then(row => row && row.version);\n    }\n  }\n\n  addMigrationDone(migration) {\n    return this.store.insertOne(migration);\n  }\n}\n"]}