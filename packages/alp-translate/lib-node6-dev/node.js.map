{"version":3,"sources":["../src/node.js"],"names":[],"mappings":";;;;;kBAKwB,Y;;AALxB;;;;AACA;;;;;;AAEA,MAAM,SAAS,gCAAW,eAAX,CAAf;;AAEe,SAAS,YAAT,CAAsB,OAAtB,EAA+B;AAC1C,cAAU,QAAQ,OAAR,CAAgB,MAAhB,EAAwB,GAAxB,CAAV;AACA,WAAO,OAAO;AACV,eAAO,MAAP,CAAc,IAAI,OAAlB,EAA2B;AACvB,cAAE,GAAF,EAAe,IAAf,EAAsC;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA,6BAApC,GAAoC;AAAA,+HAApC,GAAoC;AAAA;;AAAA,sBAAvB,IAAuB,YAAvB,IAAuB,YAAhB,MAAgB;AAAA,iIAAvB,IAAuB;AAAA;;AAClC,sBAAM,MAAM,IAAI,YAAJ,CAAiB,GAAjB,CAAqB,KAAK,QAA1B,EAAoC,GAApC,CAAwC,GAAxC,CAAZ;AACA,oBAAI,CAAC,GAAL,EAAU;AACN,2BAAO,IAAP,CAAY,aAAZ,EAA2B,EAAE,UAAU,KAAK,QAAjB,EAA2B,GAA3B,EAA3B;AACA,2BAAO,GAAP;AACH;;AALiC,0BAO3B,IAAI,MAAJ,CAAW,IAAX,CAP2B;AAQrC;AATsB,SAA3B;;AAYA,YAAI,YAAJ,GAAmB,IAAI,GAAJ,EAAnB;AACA,YAAI,MAAJ,CAAW,GAAX,CAAe,oBAAf,EAAqC,OAArC,CAA6C,YAAY;AACrD,kBAAM,eAAe,IAAI,MAAJ,CAAW,cAAX,CAA0B,UAAU,QAApC,CAArB;AACA,gBAAI,YAAJ,CAAiB,GAAjB,CAAqB,QAArB,EAA+B,oBAAK,YAAL,EAAmB,QAAnB,CAA/B;AACH,SAHD;AAIH,KAlBD;AAmBH","file":"node.js","sourcesContent":["import Logger from 'nightingale-logger';\nimport load from './load';\n\nconst logger = new Logger('alp.translate');\n\nexport default function alpTranslate(dirname) {\n    dirname = dirname.replace(/\\/*$/, '/');\n    return app => {\n        Object.assign(app.context, {\n            t(key: string, args: ?Object): string {\n                const msg = app.translations.get(this.language).get(key);\n                if (!msg) {\n                    logger.warn('invalid msg', { language: this.language, key });\n                    return key;\n                }\n\n                return msg.format(args);\n            },\n        });\n\n        app.translations = new Map();\n        app.config.get('availableLanguages').forEach(language => {\n            const translations = app.config.loadConfigSync(dirname + language);\n            app.translations.set(language, load(translations, language));\n        });\n    };\n}\n"]}