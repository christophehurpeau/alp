{"version":3,"file":"index-browser-dev.es.js","sources":["../src/load.ts","../src/browser.ts"],"sourcesContent":["import IntlMessageFormat from 'intl-messageformat';\n\nexport type Translations = ReadonlyMap<string, IntlMessageFormat>;\n\nexport default function load(\n  translations: Map<string, any>,\n  language: string,\n): Translations {\n  const result = new Map();\n\n  (function loadMap(map, prefix) {\n    map.forEach((value, key) => {\n      if (typeof value === 'object') {\n        return loadMap(value, `${prefix}${key}.`);\n      }\n\n      result.set(`${prefix}${key}`, new IntlMessageFormat(value, language));\n    });\n  })(translations, '');\n\n  return result;\n}\n","import { BrowserApplicationInCreation, Context } from 'alp-types';\nimport load from './load';\n\nexport default function alpTranslate(dirname: string) {\n  dirname = dirname.replace(/\\/*$/, '/');\n  return (app: BrowserApplicationInCreation) => {\n    const language = app.context.language;\n    // eslint-disable-next-line @typescript-eslint/ban-ts-ignore\n    // @ts-ignore\n    return app.loadConfig(dirname + language).then((map) => {\n      const translations = load(map, language);\n\n      Object.assign(app.context, {\n        t(this: Context, key: string, args?: { [key: string]: any }): string {\n          const msg = translations.get(key);\n          if (!msg) return key;\n          return msg.format(args);\n        },\n      });\n\n      return map;\n    });\n  };\n}\n"],"names":["load","translations","language","result","Map","loadMap","map","prefix","forEach","value","key","set","IntlMessageFormat","alpTranslate","dirname","replace","app","context","loadConfig","then","Object","assign","t","args","msg","get","format"],"mappings":";;AAIe,SAASA,IAAT,CACbC,YADa,EAEbC,QAFa,EAGC;AACd,MAAMC,MAAM,GAAG,IAAIC,GAAJ,EAAf;;AAEA,GAAC,SAASC,OAAT,CAAiBC,GAAjB,EAAsBC,MAAtB,EAA8B;AAC7BD,IAAAA,GAAG,CAACE,OAAJ,CAAY,UAACC,KAAD,EAAQC,GAAR,EAAgB;AAC1B,UAAI,OAAOD,KAAP,KAAiB,QAArB,EAA+B;AAC7B,eAAOJ,OAAO,CAACI,KAAD,OAAWF,MAAX,GAAoBG,GAApB,OAAd;AACD;;AAEDP,MAAAA,MAAM,CAACQ,GAAP,MAAcJ,MAAd,GAAuBG,GAAvB,EAA8B,IAAIE,iBAAJ,CAAsBH,KAAtB,EAA6BP,QAA7B,CAA9B;AACD,KAND;AAOD,GARD,EAQGD,YARH,EAQiB,EARjB;;AAUA,SAAOE,MAAP;AACD;;AClBc,SAASU,YAAT,CAAsBC,OAAtB,EAAuC;AACpDA,EAAAA,OAAO,GAAGA,OAAO,CAACC,OAAR,CAAgB,MAAhB,EAAwB,GAAxB,CAAV;AACA,SAAO,UAACC,GAAD,EAAuC;AAC5C,QAAMd,QAAQ,GAAGc,GAAG,CAACC,OAAJ,CAAYf,QAA7B,CAD4C;AAG5C;;AACA,WAAOc,GAAG,CAACE,UAAJ,CAAeJ,OAAO,GAAGZ,QAAzB,EAAmCiB,IAAnC,CAAwC,UAACb,GAAD,EAAS;AACtD,UAAML,YAAY,GAAGD,IAAI,CAACM,GAAD,EAAMJ,QAAN,CAAzB;AAEAkB,MAAAA,MAAM,CAACC,MAAP,CAAcL,GAAG,CAACC,OAAlB,EAA2B;AACzBK,QAAAA,CADyB,aACRZ,GADQ,EACKa,IADL,EAC4C;AACnE,cAAMC,GAAG,GAAGvB,YAAY,CAACwB,GAAb,CAAiBf,GAAjB,CAAZ;AACA,cAAI,CAACc,GAAL,EAAU,OAAOd,GAAP;AACV,iBAAOc,GAAG,CAACE,MAAJ,CAAWH,IAAX,CAAP;AACD;AALwB,OAA3B;AAQA,aAAOjB,GAAP;AACD,KAZM,CAAP;AAaD,GAjBD;AAkBD;;;;"}