{"version":3,"sources":["../src/node.js"],"names":[],"mappings":"AAAA,OAAO,MAAP,MAAmB,oBAAnB;AACA,OAAO,IAAP,MAAiB,QAAjB;;AAEA,IAAM,SAAS,IAAI,MAAJ,CAAW,eAAX,CAAf;;AAEA,eAAe,SAAS,YAAT,CAAsB,OAAtB,EAA+B;AAC1C,cAAU,QAAQ,OAAR,CAAgB,MAAhB,EAAwB,GAAxB,CAAV;AACA,WAAO,eAAO;AACV,eAAO,MAAP,CAAc,IAAI,OAAlB,EAA2B;AACvB,aADuB,aACrB,GADqB,EACR,IADQ,EACe;AAClC,oBAAM,MAAM,IAAI,YAAJ,CAAiB,GAAjB,CAAqB,KAAK,QAA1B,EAAoC,GAApC,CAAwC,GAAxC,CAAZ;AACA,oBAAI,CAAC,GAAL,EAAU;AACN,2BAAO,IAAP,CAAY,aAAZ,EAA2B,EAAE,UAAU,KAAK,QAAjB,EAA2B,QAA3B,EAA3B;AACA,2BAAO,GAAP;AACH;;AAED,uBAAO,IAAI,MAAJ,CAAW,IAAX,CAAP;AACH;AATsB,SAA3B;;AAYA,YAAI,YAAJ,GAAmB,IAAI,GAAJ,EAAnB;AACA,YAAI,MAAJ,CAAW,GAAX,CAAe,oBAAf,EAAqC,OAArC,CAA6C,oBAAY;AACrD,gBAAM,eAAe,IAAI,MAAJ,CAAW,cAAX,CAA0B,UAAU,QAApC,CAArB;AACA,gBAAI,YAAJ,CAAiB,GAAjB,CAAqB,QAArB,EAA+B,KAAK,YAAL,EAAmB,QAAnB,CAA/B;AACH,SAHD;AAIH,KAlBD;AAmBH","file":"node.js","sourcesContent":["import Logger from 'nightingale-logger';\nimport load from './load';\n\nconst logger = new Logger('alp.translate');\n\nexport default function alpTranslate(dirname) {\n    dirname = dirname.replace(/\\/*$/, '/');\n    return app => {\n        Object.assign(app.context, {\n            t(key: string, args: ?Object): string {\n                const msg = app.translations.get(this.language).get(key);\n                if (!msg) {\n                    logger.warn('invalid msg', { language: this.language, key });\n                    return key;\n                }\n\n                return msg.format(args);\n            },\n        });\n\n        app.translations = new Map();\n        app.config.get('availableLanguages').forEach(language => {\n            const translations = app.config.loadConfigSync(dirname + language);\n            app.translations.set(language, load(translations, language));\n        });\n    };\n}\n"]}