{"version":3,"sources":["../../src/redux/middleware.js"],"names":["Logger","logger","action","meta","websocket","next","promise","app","emit","type","resolved","setTimeout","warn","console","log","clearTimeout","store","dispatch"],"mappings":"AAAA,OAAOA,MAAP;;AAEA,IAAMC,SAAS,IAAID,MAAJ,CAAW,0BAAX,CAAf;;AAEA,gBAAe;AAAA,SAAO;AAAA,WAAS;AAAA,aAAQ,kBAAU;AAC/C,YAAI,CAACE,OAAOC,IAAR,IAAgB,CAACD,OAAOC,IAAP,CAAYC,SAAjC,EAA4C;AAC1C,iBAAOC,KAAKH,MAAL,CAAP;AACD;;AAED,YAAI,CAACA,OAAOC,IAAP,CAAYG,OAAjB,EAA0B;AACxBC,cAAIH,SAAJ,CAAcI,IAAd,CAAmBN,OAAOO,IAA1B,EAAgCP,MAAhC;AACA;AACD;;AAED,YAAMQ,WAAWC,WAAW,YAAM;AAChCV,iBAAOW,IAAP,CAAY,wBAAZ,EAAsC,EAAEV,cAAF,EAAtC;AACA;AACAW,kBAAQC,GAAR,CAAY,wCAAZ,EAAsDZ,MAAtD;AACD,SAJgB,EAId,KAJc,CAAjB;;AAMAK,YAAIH,SAAJ,CAAcI,IAAd,CAAmBN,OAAOO,IAA1B,EAAgCP,MAAhC,EAAwC,kBAAU;AAChDa,uBAAaL,QAAb;AACA,cAAIR,MAAJ,EAAY;AACVc,kBAAMC,QAAN,CAAef,MAAf;AACD;AACF,SALD;AAMD,OAtB8B;AAAA,KAAT;AAAA,GAAP;AAAA,CAAf","file":"middleware.js","sourcesContent":["import Logger from 'nightingale-logger/src';\n\nconst logger = new Logger('alp-websocket:middleware');\n\nexport default app => store => next => action => {\n  if (!action.meta || !action.meta.websocket) {\n    return next(action);\n  }\n\n  if (!action.meta.promise) {\n    app.websocket.emit(action.type, action);\n    return;\n  }\n\n  const resolved = setTimeout(() => {\n    logger.warn('websocket emit timeout', { action });\n    // eslint-disable-next-line no-console\n    console.log('alp.react-redux websocket emit timeout', action);\n  }, 10000);\n\n  app.websocket.emit(action.type, action, action => {\n    clearTimeout(resolved);\n    if (action) {\n      store.dispatch(action);\n    }\n  });\n};\n"]}