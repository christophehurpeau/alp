{"version":3,"file":"index-node14.mjs","sources":["../src/createAlpAppWrapper.tsx","../src/layout/assetUrl.ts","../src/layout/uneval.ts","../src/layout/htmlLayout.ts","../src/contexts/LoadingFallbackContext.ts","../src/module/AlpModule.tsx","../src/module/SuspenseWrapper.tsx","../src/layout/Body.tsx","../src/layout/AppContainer.tsx","../src/index.ts"],"sourcesContent":["import type { Context } from 'alp-types';\nimport type {\n  ComponentClass,\n  ErrorInfo,\n  ReactChild,\n  ReactElement,\n} from 'react';\nimport { Component } from 'react';\nimport ReactAlpContext from 'react-alp-context';\n\ndeclare global {\n  interface Window {\n    Sentry?: { captureException: (error: Error, extra: unknown) => void };\n  }\n}\n\n// eslint-disable-next-line @typescript-eslint/no-empty-interface\ninterface AlpAppProps {}\n\ninterface AlpAppState {\n  error: null | Error;\n}\n\nexport default function createAlpAppWrapper(\n  app: ReactChild,\n  context: Context,\n): ComponentClass<AlpAppProps, AlpAppState> {\n  return class AlpAppWrapper extends Component<AlpAppProps, AlpAppState> {\n    state = {\n      error: null,\n    };\n\n    componentDidCatch(error: Error, errorInfo: ErrorInfo): void {\n      console.error(error, errorInfo);\n      if (window.Sentry) {\n        window.Sentry.captureException(error, {\n          contexts: {\n            react: {\n              componentStack: errorInfo.componentStack,\n            },\n          },\n        });\n      }\n    }\n\n    render(): ReactElement {\n      if (this.state.error) return <div>An unexpected error occured</div>;\n      return (\n        <ReactAlpContext.Provider value={context}>\n          {app}\n        </ReactAlpContext.Provider>\n      );\n    }\n  };\n}\n","import { IS_DEV } from 'pob-babel';\n\nexport type AssetUrl = (asset: string, version: string) => string;\n\nconst assetUrl: AssetUrl = !IS_DEV\n  ? (asset: string, version: string): string =>\n      asset.startsWith('/') ? `/${version}${asset}` : asset\n  : (asset: string, version: string): string =>\n      asset.startsWith('/') ? `${asset}?${version}` : asset;\n\nexport default assetUrl;\n","/* eslint-disable complexity */\n\nimport { IS_DEV } from 'pob-babel';\n\nfunction uneval(\n  value: unknown,\n  keys: undefined | string,\n  objects = new Set(),\n): string {\n  switch (value) {\n    case null:\n      return 'null';\n    case undefined:\n      return 'undefined';\n    case Infinity:\n      return 'Infinity';\n    case -Infinity:\n      return '-Infinity';\n  }\n\n  if (Number.isNaN(value)) {\n    return 'NaN';\n  }\n\n  // eslint-disable-next-line @typescript-eslint/switch-exhaustiveness-check\n  switch (typeof value) {\n    case 'function':\n      if (IS_DEV) console.log(value);\n      throw new Error(!IS_DEV ? undefined : `Unsupported function \"${keys!}\".`);\n    case 'string':\n    case 'number':\n    case 'boolean':\n      return JSON.stringify(value);\n  }\n\n  if (objects.has(value)) {\n    throw new Error(!IS_DEV ? undefined : 'Circular reference detected.');\n  }\n\n  objects.add(value);\n\n  // specialized types\n  if (Array.isArray(value)) {\n    return `[${value\n      .map((o, index) =>\n        uneval(o, !IS_DEV ? undefined : `${keys!}[${index}]`, objects),\n      )\n      .join(',')}]`;\n  }\n\n  if (value instanceof Date) {\n    return `new Date(${value.getTime()})`;\n  }\n\n  if (value instanceof Set) {\n    return `new Set(${uneval([...value], keys)})`;\n  }\n\n  if (value instanceof Map) {\n    return `new Map(${uneval([...value], keys)})`;\n  }\n\n  return `{${Object.keys(value as Record<any, unknown>)\n    .map(\n      (key) =>\n        `${JSON.stringify(key)}:${uneval(\n          (value as Record<typeof key, unknown>)[key],\n          !IS_DEV ? undefined : `${keys!}.${key}`,\n        )}`,\n    )\n    .join(',')}}`;\n}\n\n// https://medium.com/node-security/the-most-common-xss-vulnerability-in-react-js-applications-2bdffbcc1fa0#.tm3hd6riw\nconst UNSAFE_CHARS_REGEXP = /[/<>\\u2028\\u2029]/g;\nconst ESCAPED_CHARS = {\n  '<': '\\\\u003C',\n  '>': '\\\\u003E',\n  '/': '\\\\u002F',\n  '\\u2028': '\\\\u2028',\n  '\\u2029': '\\\\u2029',\n};\n\nconst escapeUnsafeChars = (unsafeChar: keyof typeof ESCAPED_CHARS): string =>\n  ESCAPED_CHARS[unsafeChar];\n\nexport default function unevalValue(value: unknown): string {\n  return uneval(value, !IS_DEV ? undefined : 'obj').replace(\n    UNSAFE_CHARS_REGEXP,\n    escapeUnsafeChars as (unsafeChar: string) => string,\n  );\n}\n","import type { HelmetData } from 'react-helmet';\nimport assetUrl from './assetUrl';\nimport uneval from './uneval';\n\nexport interface LayoutOptions {\n  version: string;\n  scriptName: string | false;\n  styleName: string | false;\n  initialData?: any;\n  polyfillFeatures?: string;\n}\n\nexport default function htmlLayout(\n  helmet: HelmetData,\n  content: string,\n  {\n    version,\n    scriptName,\n    styleName,\n    initialData,\n    polyfillFeatures = 'default,es2015,es2016,es2017,localStorage,fetch,Intl',\n  }: LayoutOptions,\n): string {\n  return `<!doctype html>\n<html ${helmet.htmlAttributes.toString()}>\n  <head>\n    ${helmet.title.toString()}\n    ${helmet.meta.toString()}\n    ${helmet.link.toString()}\n    ${helmet.base.toString()}\n    <link rel=\"stylesheet\" href=\"${assetUrl(\n      `/${styleName || 'index'}.css`,\n      version,\n    )}\" />\n    ${helmet.style.toString()}\n    ${\n      polyfillFeatures &&\n      `<script defer src=\"${`https://polyfill.io/v2/polyfill.min.js?features=${polyfillFeatures}&unknown=polyfill`}\"></script>`\n    }\n    ${helmet.script.toString()}\n    ${\n      scriptName === false\n        ? ''\n        : `<script>\nwindow.__VERSION__='${version}';\nwindow.__INITIAL_DATA__=${uneval(initialData)};\n</script>\n<script defer src=\"${assetUrl(`/${scriptName}.js`, version)}\"></script>`\n    }\n  </head>\n  <body ${helmet.bodyAttributes.toString()}>\n    <div id=\"react-app\">${content}</div>\n  </body>\n</html>`;\n}\n","import type { ReactNode } from 'react';\nimport { createContext } from 'react';\n\nexport default createContext<NonNullable<ReactNode>>('Loading...');\n","import { POB_TARGET } from 'pob-babel';\nimport type { ReactElement, ReactNode } from 'react';\nimport { Suspense, useContext } from 'react';\nimport LoadingFallbackContext from '../contexts/LoadingFallbackContext';\n\nexport interface AlpModuleProps {\n  children: ReactNode;\n}\n\nfunction AlpModuleNode(props: AlpModuleProps): ReactElement {\n  return props.children as ReactElement;\n}\n\nfunction AlpModuleBrowser(props: AlpModuleProps): ReactElement {\n  const loadingFallback = useContext(LoadingFallbackContext);\n  return <Suspense fallback={loadingFallback}>{props.children}</Suspense>;\n}\n\nexport default POB_TARGET === 'node' ? AlpModuleNode : AlpModuleBrowser;\n","import { POB_TARGET } from 'pob-babel';\nimport type { ReactElement, ReactNode } from 'react';\nimport { Suspense, useContext } from 'react';\nimport LoadingFallbackContext from '../contexts/LoadingFallbackContext';\n\ninterface SuspenseWrapperProps {\n  children: ReactNode;\n}\n\nfunction NodeSuspenseWrapper({ children }: SuspenseWrapperProps): ReactElement {\n  return children as unknown as ReactElement;\n}\n\nfunction BrowserSuspenseWrapper({\n  children,\n}: SuspenseWrapperProps): ReactElement {\n  const loader = useContext(LoadingFallbackContext);\n  return <Suspense fallback={loader}>{children}</Suspense>;\n}\n\nexport default POB_TARGET === 'node'\n  ? NodeSuspenseWrapper\n  : BrowserSuspenseWrapper;\n","import type { ReactElement, ReactNode } from 'react';\n\nexport interface BodyProps {\n  children: ReactNode;\n}\n\nexport default function Body({ children }: BodyProps): ReactElement<'div'> {\n  return <div>{children}</div>;\n}\n","import type { ReactElement } from 'react';\nimport type React from 'react';\n\nexport interface AppContainerProps {\n  children: React.ReactNode;\n}\n\nexport default function AppContainer({\n  children,\n}: AppContainerProps): ReactElement {\n  return children as ReactElement;\n}\n","import type { Context } from 'alp-types';\nimport isModernBrowser from 'modern-browsers';\nimport type { ElementType, ReactElement } from 'react';\nimport React from 'react';\nimport { renderToString } from 'react-dom/server.js';\nimport { Helmet } from 'react-helmet';\n// import { Logger } from 'nightingale-logger';\nimport createAlpAppWrapper from './createAlpAppWrapper';\nimport type { LayoutOptions } from './layout/htmlLayout';\nimport htmlLayout from './layout/htmlLayout';\n\nexport { Helmet } from 'react-helmet';\nexport { default as AlpModule } from './module/AlpModule';\nexport { default as SuspenseWrapper } from './module/SuspenseWrapper';\nexport { default as Body } from './layout/Body';\nexport { default as AppContainer } from './layout/AppContainer';\nexport { default as LoadingFallbackContext } from './contexts/LoadingFallbackContext';\n\n// const logger = new Logger( 'alp:react');\n\nconst renderHtml = (app: ReactElement, options: LayoutOptions): string => {\n  const content = renderToString(app);\n  const helmet = Helmet.renderStatic();\n  return htmlLayout(helmet, content, options);\n};\n\ninterface Options {\n  polyfillFeatures?: string;\n  scriptName?: string | false;\n  styleName?: string | false;\n}\n\nexport type ReactAppCallback = (ctx: Context) => void;\n\nexport default function alpReact(\n  App: ElementType<Record<string, never>>,\n  options: Options = {},\n): ReactAppCallback {\n  return (ctx: Context): void => {\n    const version: string = ctx.config.get('version');\n    // TODO create alp-useragent with getter in context\n    const ua = ctx.request.headers['user-agent'];\n    const name = isModernBrowser(ua) ? 'modern-browsers' : 'es5';\n\n    const app = React.createElement(App);\n    const WrappedApp = createAlpAppWrapper(app, ctx);\n\n    ctx.body = renderHtml(React.createElement(WrappedApp), {\n      version,\n      scriptName: options.scriptName !== undefined ? options.scriptName : name,\n      styleName: options.styleName !== undefined ? options.styleName : name,\n      polyfillFeatures: options.polyfillFeatures,\n      initialData: {\n        sanitizedState: ctx.sanitizedState,\n      },\n    });\n  };\n}\n"],"names":["createAlpAppWrapper","app","context","AlpAppWrapper","Component","state","error","componentDidCatch","errorInfo","console","window","Sentry","captureException","contexts","react","componentStack","render","_jsx","assetUrl","asset","version","startsWith","uneval","value","keys","objects","Set","undefined","Infinity","Number","isNaN","log","Error","JSON","stringify","has","add","Array","isArray","map","o","index","join","Date","getTime","Map","Object","key","UNSAFE_CHARS_REGEXP","ESCAPED_CHARS","escapeUnsafeChars","unsafeChar","unevalValue","replace","htmlLayout","helmet","content","scriptName","styleName","initialData","polyfillFeatures","htmlAttributes","toString","title","meta","link","base","style","script","bodyAttributes","createContext","AlpModuleNode","props","children","NodeSuspenseWrapper","Body","AppContainer","renderHtml","options","renderToString","Helmet","renderStatic","alpReact","App","ctx","config","get","ua","request","headers","name","isModernBrowser","React","createElement","WrappedApp","body","sanitizedState"],"mappings":"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"}