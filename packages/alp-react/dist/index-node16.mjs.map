{"version":3,"file":"index-node16.mjs","sources":["../src/createAlpAppWrapper.tsx","../src/layout/assetUrl.ts","../src/layout/uneval.ts","../src/layout/htmlLayout.ts","../src/contexts/LoadingFallbackContext.ts","../src/module/AlpModule.tsx","../src/module/SuspenseWrapper.tsx","../src/layout/Body.tsx","../src/layout/AppContainer.tsx","../src/index.ts"],"sourcesContent":["import type { Context } from 'alp-types';\nimport type {\n  ComponentClass,\n  ErrorInfo,\n  ReactChild,\n  ReactElement,\n} from 'react';\nimport { Component } from 'react';\nimport ReactAlpContext from 'react-alp-context';\n\ndeclare global {\n  interface Window {\n    Sentry?: { captureException: (error: Error, extra: unknown) => void };\n  }\n}\n\n// eslint-disable-next-line @typescript-eslint/no-empty-interface\ninterface AlpAppProps {}\n\ninterface AlpAppState {\n  error: null | Error;\n}\n\nexport default function createAlpAppWrapper(\n  app: ReactChild,\n  context: Context,\n): ComponentClass<AlpAppProps, AlpAppState> {\n  return class AlpAppWrapper extends Component<AlpAppProps, AlpAppState> {\n    state = {\n      error: null,\n    };\n\n    componentDidCatch(error: Error, errorInfo: ErrorInfo): void {\n      console.error(error, errorInfo);\n      if (window.Sentry) {\n        window.Sentry.captureException(error, {\n          contexts: {\n            react: {\n              componentStack: errorInfo.componentStack,\n            },\n          },\n        });\n      }\n    }\n\n    render(): ReactElement {\n      if (this.state.error) return <div>An unexpected error occured</div>;\n      return (\n        <ReactAlpContext.Provider value={context}>\n          {app}\n        </ReactAlpContext.Provider>\n      );\n    }\n  };\n}\n","import { IS_DEV } from 'pob-babel';\n\nexport type AssetUrl = (asset: string, version: string) => string;\n\nconst assetUrl: AssetUrl = !IS_DEV\n  ? (asset: string, version: string): string =>\n      asset.startsWith('/') ? `/${version}${asset}` : asset\n  : (asset: string, version: string): string =>\n      asset.startsWith('/') ? `${asset}?${version}` : asset;\n\nexport default assetUrl;\n","/* eslint-disable complexity */\n\nimport { IS_DEV } from 'pob-babel';\n\nfunction uneval(\n  value: unknown,\n  keys: undefined | string,\n  objects = new Set(),\n): string {\n  switch (value) {\n    case null:\n      return 'null';\n    case undefined:\n      return 'undefined';\n    case Infinity:\n      return 'Infinity';\n    case -Infinity:\n      return '-Infinity';\n  }\n\n  if (Number.isNaN(value)) {\n    return 'NaN';\n  }\n\n  // eslint-disable-next-line @typescript-eslint/switch-exhaustiveness-check\n  switch (typeof value) {\n    case 'function':\n      if (IS_DEV) console.log(value);\n      throw new Error(!IS_DEV ? undefined : `Unsupported function \"${keys!}\".`);\n    case 'string':\n    case 'number':\n    case 'boolean':\n      return JSON.stringify(value);\n  }\n\n  if (objects.has(value)) {\n    throw new Error(!IS_DEV ? undefined : 'Circular reference detected.');\n  }\n\n  objects.add(value);\n\n  // specialized types\n  if (Array.isArray(value)) {\n    return `[${value\n      .map((o, index) =>\n        uneval(o, !IS_DEV ? undefined : `${keys!}[${index}]`, objects),\n      )\n      .join(',')}]`;\n  }\n\n  if (value instanceof Date) {\n    return `new Date(${value.getTime()})`;\n  }\n\n  if (value instanceof Set) {\n    return `new Set(${uneval([...value], keys)})`;\n  }\n\n  if (value instanceof Map) {\n    return `new Map(${uneval([...value], keys)})`;\n  }\n\n  return `{${Object.keys(value as Record<any, unknown>)\n    .map(\n      (key) =>\n        `${JSON.stringify(key)}:${uneval(\n          (value as Record<typeof key, unknown>)[key],\n          !IS_DEV ? undefined : `${keys!}.${key}`,\n        )}`,\n    )\n    .join(',')}}`;\n}\n\n// https://medium.com/node-security/the-most-common-xss-vulnerability-in-react-js-applications-2bdffbcc1fa0#.tm3hd6riw\nconst UNSAFE_CHARS_REGEXP = /[/<>\\u2028\\u2029]/g;\nconst ESCAPED_CHARS = {\n  '<': '\\\\u003C',\n  '>': '\\\\u003E',\n  '/': '\\\\u002F',\n  '\\u2028': '\\\\u2028',\n  '\\u2029': '\\\\u2029',\n};\n\nconst escapeUnsafeChars = (unsafeChar: keyof typeof ESCAPED_CHARS): string =>\n  ESCAPED_CHARS[unsafeChar];\n\nexport default function unevalValue(value: unknown): string {\n  return uneval(value, !IS_DEV ? undefined : 'obj').replace(\n    UNSAFE_CHARS_REGEXP,\n    escapeUnsafeChars as (unsafeChar: string) => string,\n  );\n}\n","import type { HelmetData } from 'react-helmet';\nimport assetUrl from './assetUrl';\nimport uneval from './uneval';\n\nexport interface LayoutOptions {\n  version: string;\n  scriptName: string | false;\n  styleName: string | false;\n  initialData?: any;\n  polyfillFeatures?: string;\n}\n\nexport default function htmlLayout(\n  helmet: HelmetData,\n  content: string,\n  {\n    version,\n    scriptName,\n    styleName,\n    initialData,\n    polyfillFeatures = 'default,es2015,es2016,es2017,localStorage,fetch,Intl',\n  }: LayoutOptions,\n): string {\n  return `<!doctype html>\n<html ${helmet.htmlAttributes.toString()}>\n  <head>\n    ${helmet.title.toString()}\n    ${helmet.meta.toString()}\n    ${helmet.link.toString()}\n    ${helmet.base.toString()}\n    <link rel=\"stylesheet\" href=\"${assetUrl(\n      `/${styleName || 'index'}.css`,\n      version,\n    )}\" />\n    ${helmet.style.toString()}\n    ${\n      polyfillFeatures &&\n      `<script defer src=\"${`https://polyfill.io/v2/polyfill.min.js?features=${polyfillFeatures}&unknown=polyfill`}\"></script>`\n    }\n    ${helmet.script.toString()}\n    ${\n      scriptName === false\n        ? ''\n        : `<script>\nwindow.__VERSION__='${version}';\nwindow.__INITIAL_DATA__=${uneval(initialData)};\n</script>\n<script defer src=\"${assetUrl(`/${scriptName}.js`, version)}\"></script>`\n    }\n  </head>\n  <body ${helmet.bodyAttributes.toString()}>\n    <div id=\"react-app\">${content}</div>\n  </body>\n</html>`;\n}\n","import type { ReactNode } from 'react';\nimport { createContext } from 'react';\n\nexport default createContext<NonNullable<ReactNode>>('Loading...');\n","import { POB_TARGET } from 'pob-babel';\nimport type { ReactElement, ReactNode } from 'react';\nimport { Suspense, useContext } from 'react';\nimport LoadingFallbackContext from '../contexts/LoadingFallbackContext';\n\nexport interface AlpModuleProps {\n  children: ReactNode;\n}\n\nfunction AlpModuleNode(props: AlpModuleProps): ReactElement {\n  return props.children as ReactElement;\n}\n\nfunction AlpModuleBrowser(props: AlpModuleProps): ReactElement {\n  const loadingFallback = useContext(LoadingFallbackContext);\n  return <Suspense fallback={loadingFallback}>{props.children}</Suspense>;\n}\n\nexport default POB_TARGET === 'node' ? AlpModuleNode : AlpModuleBrowser;\n","import { POB_TARGET } from 'pob-babel';\nimport type { ReactElement, ReactNode } from 'react';\nimport { Suspense, useContext } from 'react';\nimport LoadingFallbackContext from '../contexts/LoadingFallbackContext';\n\ninterface SuspenseWrapperProps {\n  children: ReactNode;\n}\n\nfunction NodeSuspenseWrapper({ children }: SuspenseWrapperProps): ReactElement {\n  return children as unknown as ReactElement;\n}\n\nfunction BrowserSuspenseWrapper({\n  children,\n}: SuspenseWrapperProps): ReactElement {\n  const loader = useContext(LoadingFallbackContext);\n  return <Suspense fallback={loader}>{children}</Suspense>;\n}\n\nexport default POB_TARGET === 'node'\n  ? NodeSuspenseWrapper\n  : BrowserSuspenseWrapper;\n","import type { ReactElement, ReactNode } from 'react';\n\nexport interface BodyProps {\n  children: ReactNode;\n}\n\nexport default function Body({ children }: BodyProps): ReactElement<'div'> {\n  return <div>{children}</div>;\n}\n","import type { ReactElement } from 'react';\nimport type React from 'react';\n\nexport interface AppContainerProps {\n  children: React.ReactNode;\n}\n\nexport default function AppContainer({\n  children,\n}: AppContainerProps): ReactElement {\n  return children as ReactElement;\n}\n","import type { Context } from 'alp-types';\nimport isModernBrowser from 'modern-browsers';\nimport type { ElementType, ReactElement } from 'react';\nimport React from 'react';\nimport { renderToString } from 'react-dom/server.js';\nimport { Helmet } from 'react-helmet';\n// import { Logger } from 'nightingale-logger';\nimport createAlpAppWrapper from './createAlpAppWrapper';\nimport type { LayoutOptions } from './layout/htmlLayout';\nimport htmlLayout from './layout/htmlLayout';\n\nexport { Helmet } from 'react-helmet';\nexport { default as AlpModule } from './module/AlpModule';\nexport { default as SuspenseWrapper } from './module/SuspenseWrapper';\nexport { default as Body } from './layout/Body';\nexport { default as AppContainer } from './layout/AppContainer';\nexport { default as LoadingFallbackContext } from './contexts/LoadingFallbackContext';\n\n// const logger = new Logger( 'alp:react');\n\nconst renderHtml = (app: ReactElement, options: LayoutOptions): string => {\n  const content = renderToString(app);\n  const helmet = Helmet.renderStatic();\n  return htmlLayout(helmet, content, options);\n};\n\ninterface Options {\n  polyfillFeatures?: string;\n  scriptName?: string | false;\n  styleName?: string | false;\n}\n\nexport type ReactAppCallback = (ctx: Context) => void;\n\nexport default function alpReact(\n  App: ElementType<Record<string, never>>,\n  options: Options = {},\n): ReactAppCallback {\n  return (ctx: Context): void => {\n    const version: string = ctx.config.get('version');\n    // TODO create alp-useragent with getter in context\n    const ua = ctx.request.headers['user-agent'];\n    const name = isModernBrowser(ua) ? 'modern-browsers' : 'es5';\n\n    const app = React.createElement(App);\n    const WrappedApp = createAlpAppWrapper(app, ctx);\n\n    ctx.body = renderHtml(React.createElement(WrappedApp), {\n      version,\n      scriptName: options.scriptName !== undefined ? options.scriptName : name,\n      styleName: options.styleName !== undefined ? options.styleName : name,\n      polyfillFeatures: options.polyfillFeatures,\n      initialData: {\n        sanitizedState: ctx.sanitizedState,\n      },\n    });\n  };\n}\n"],"names":["createAlpAppWrapper","app","context","AlpAppWrapper","Component","state","error","componentDidCatch","errorInfo","console","window","Sentry","captureException","contexts","react","componentStack","render","_jsx","assetUrl","asset","version","startsWith","uneval","value","keys","objects","Set","undefined","Infinity","Number","isNaN","log","Error","JSON","stringify","has","add","Array","isArray","map","o","index","join","Date","getTime","Map","Object","key","UNSAFE_CHARS_REGEXP","ESCAPED_CHARS","escapeUnsafeChars","unsafeChar","unevalValue","replace","htmlLayout","helmet","content","scriptName","styleName","initialData","polyfillFeatures","htmlAttributes","toString","title","meta","link","base","style","script","bodyAttributes","createContext","AlpModuleNode","props","children","NodeSuspenseWrapper","Body","AppContainer","renderHtml","options","renderToString","Helmet","renderStatic","alpReact","App","ctx","config","get","ua","request","headers","name","isModernBrowser","React","createElement","WrappedApp","body","sanitizedState"],"mappings":"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"}