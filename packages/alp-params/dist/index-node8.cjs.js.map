{"version":3,"file":"index-node8.cjs.js","sources":["../src/ParamValueValidator.js","../src/ParamValueStringValidator.js","../src/ParamValidator.js","../src/ParamValidatorValid.js","../src/index.js"],"sourcesContent":["export default class ParamValueValidator {\n  constructor(validator, name, value) {\n    this.validator = validator;\n    this.name = name;\n    this.value = value;\n  }\n\n  _error(key) {\n    this.validator._error(this.name, key, this.value);\n  }\n}\n","import ParamValueValidator from './ParamValueValidator';\n\nexport default class ParamValueStringValidator extends ParamValueValidator {\n  notEmpty() {\n    if (this.value == null || this.value.trim() === '') {\n      this._error('notEmpty');\n    }\n\n    return this;\n  }\n}\n","import ParamValueStringValidator from './ParamValueStringValidator';\n\nexport default class ParamValidator {\n  constructor(context) {\n    this.context = context;\n  }\n\n  _error(name, key, value) {\n    if (!this._errors) {\n      this._errors = {};\n    }\n\n    this._errors[name] = { error: key, value };\n  }\n\n  getErrors() {\n    return this._errors;\n  }\n\n  hasErrors() {\n    return !!this._errors;\n  }\n\n  isValid() {\n    return !this._errors;\n  }\n\n  string(name, position) {\n    return new ParamValueStringValidator(this, name, this.context.param(name, position));\n  }\n  /* int(name, position) {\n   return new ParamValueIntValidator(this, name, this.context.param(name, position));\n   }\n   model(modelName, name) {\n   name = name || S.string.lcFirst(modelName);\n   console.log('paramvalidator model', modelName, M[modelName]);\n   let data = this.context.getOrPostParam(name);\n   return new ParamValueModelValidator(this, name, !data ? null : new M[modelName](data));\n   } */\n}\n","import ParamValidator from './ParamValidator';\n\nexport default class ParamValidatorValid extends ParamValidator {\n  _error() {\n    this.context.throw(404, 'Invalid params', { validator: this });\n  }\n}\n","import { defineLazyProperty } from 'object-properties';\nimport ParamValidator from './ParamValidator';\nimport ParamValidatorValid from './ParamValidatorValid';\n\nexport { ParamValidator };\n\nexport default function alpParams(app) {\n  Object.assign(app.context, {\n    param(name) {\n      return this.namedParam(name) || this.paramGET(name);\n    },\n\n    namedParam(name) {\n      let namedParams = this.route.namedParams;\n      return namedParams && namedParams.get(name);\n    },\n\n    otherParam(position) {\n      let otherParams = this.route.otherParams;\n      return otherParams && otherParams[position - 1];\n    },\n\n    paramGET(name) {\n      let query = this.query;\n      return query && query[name];\n    },\n\n    paramGETorPOST(name) {\n      return this.body[name] !== undefined ? this.body[name] : this.query[name];\n    },\n  });\n\n  defineLazyProperty(app.context, 'params', function() {\n    return new ParamValidator(this);\n  });\n\n  defineLazyProperty(app.context, 'validParams', function() {\n    return new ParamValidatorValid(this);\n  });\n}\n"],"names":["ParamValueValidator","validator","name","value","key","_error","ParamValueStringValidator","trim","ParamValidator","context","_errors","error","position","param","ParamValidatorValid","throw","alpParams","app","assign","namedParam","paramGET","namedParams","route","get","otherParams","query","body","undefined"],"mappings":";;;;;;IAAqBA,sBAAN,MAA0B;cAC3BC,SAAZ,EAAuBC,IAAvB,EAA6BC,KAA7B,EAAoC;SAC7BF,SAAL,GAAiBA,SAAjB;SACKC,IAAL,GAAYA,IAAZ;SACKC,KAAL,GAAaA,KAAb;;;SAGKC,GAAP,EAAY;SACLH,SAAL,CAAeI,MAAf,CAAsB,KAAKH,IAA3B,EAAiCE,GAAjC,EAAsC,KAAKD,KAA3C;;;;ICNiBG,4BAAN,cAAwCN,mBAAxC,CAA4D;aAC9D;QACL,KAAKG,KAAL,IAAc,IAAd,IAAsB,KAAKA,KAAL,CAAWI,IAAX,OAAsB,EAAhD,EAAoD;WAC7CF,MAAL,CAAY,UAAZ;;;WAGK,IAAP;;;;ICNiBG,iBAAN,MAAqB;cACtBC,OAAZ,EAAqB;SACdA,OAAL,GAAeA,OAAf;;;SAGKP,IAAP,EAAaE,GAAb,EAAkBD,KAAlB,EAAyB;QACnB,CAAC,KAAKO,OAAV,EAAmB;WACZA,OAAL;;;SAGGA,OAAL,CAAaR,IAAb,IAAqB,EAAES,OAAOP,GAAT,EAAcD,KAAd,EAArB;;;cAGU;WACH,KAAKO,OAAZ;;;cAGU;WACH,CAAC,CAAC,KAAKA,OAAd;;;YAGQ;WACD,CAAC,KAAKA,OAAb;;;SAGKR,IAAP,EAAaU,QAAb,EAAuB;WACd,IAAIN,yBAAJ,CAA8B,IAA9B,EAAoCJ,IAApC,EAA0C,KAAKO,OAAL,CAAaI,KAAb,CAAmBX,IAAnB,EAAyBU,QAAzB,CAA1C,CAAP;;;;;;;;;;;;;IC1BiBE,sBAAN,cAAkCN,cAAlC,CAAiD;WACrD;SACFC,OAAL,CAAaM,KAAb,CAAmB,GAAnB,EAAwB,gBAAxB,EAA0C,EAAEd,WAAW,IAAb,EAA1C;;;;ACEW,SAASe,SAAT,CAAmBC,GAAnB,EAAwB;SAC9BC,MAAP,CAAcD,IAAIR,OAAlB,EAA2B;UACnBP,IAAN,EAAY;aACH,KAAKiB,UAAL,CAAgBjB,IAAhB,KAAyB,KAAKkB,QAAL,CAAclB,IAAd,CAAhC;KAFuB;;eAKdA,IAAX,EAAiB;UACXmB,cAAc,KAAKC,KAAL,CAAWD,WAA7B;aACOA,eAAeA,YAAYE,GAAZ,CAAgBrB,IAAhB,CAAtB;KAPuB;;eAUdU,QAAX,EAAqB;UACfY,cAAc,KAAKF,KAAL,CAAWE,WAA7B;aACOA,eAAeA,YAAYZ,WAAW,CAAvB,CAAtB;KAZuB;;aAehBV,IAAT,EAAe;UACTuB,QAAQ,KAAKA,KAAjB;aACOA,SAASA,MAAMvB,IAAN,CAAhB;KAjBuB;;mBAoBVA,IAAf,EAAqB;aACZ,KAAKwB,IAAL,CAAUxB,IAAV,MAAoByB,SAApB,GAAgC,KAAKD,IAAL,CAAUxB,IAAV,CAAhC,GAAkD,KAAKuB,KAAL,CAAWvB,IAAX,CAAzD;;GArBJ;;sCAyBmBe,IAAIR,OAAvB,EAAgC,QAAhC,EAA0C,YAAW;WAC5C,IAAID,cAAJ,CAAmB,IAAnB,CAAP;GADF;;sCAImBS,IAAIR,OAAvB,EAAgC,aAAhC,EAA+C,YAAW;WACjD,IAAIK,mBAAJ,CAAwB,IAAxB,CAAP;GADF;;;;;;"}