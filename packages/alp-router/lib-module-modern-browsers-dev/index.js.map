{"version":3,"sources":["../src/index.js"],"names":["RouterType","alpRouter","router","app","context","urlGenerator","routeKey","params","toLocalizedPath","language","redirectTo","to","redirect","ctx","routeMatch","find","path","status","Error","route","ref"],"mappings":"AAAA,SAAcA,yBAAd,QAAgC,iBAAhC;;;;;;AAEA,kCAAe,OAAf;AACA,wCAAkB,WAAC,eAAK,OAAL,CAAD,WAAkB,WAAC,eAAK,UAAL,CAAD,WAAiB,iBAAQ,QAAR,CAAjB,EAAlB,EAAlB;;;AAEA,eAAe,SAASC,SAAT,CAAmBC,MAAnB,EAAmD;AAAA,oBAA1B,iBAA0B;;AAAA,+BAAX,UAAW;;AAChE,2EAAO,UAACC,GAAD,EAAkB;;AAWvB,0BAXS,OAWT,eAVAA,IAAID,MAAJ,GAAaA,MAUb,EARAC,IAAIC,OAAJ,CAAYC,YAAZ,GAA2B,UAASC,QAAT,EAA2BC,MAA3B,EAAgD;AAAA,0BAA/B,UAA+B;;AAAA,wBAAf,OAAe;;AAAA,oCAAP,UAAO;;AACzE,qIAAOL,OAAOM,eAAP,CAAuB,KAAKC,QAA5B,EAAsCH,QAAtC,EAAgDC,MAAhD,CAAP;AACD,KAMD,EAJAJ,IAAIC,OAAJ,CAAYM,UAAZ,GAAyB,UAASC,EAAT,EAAqBJ,MAArB,EAAuC;AAAA,oBAA5B,UAA4B;;AAAA,yBAAZ,OAAY;;AAAA,oCAAJ,OAAI;;AAC9D,oHAAO,KAAKK,QAAL,CAAcV,OAAOM,eAAP,CAAuB,KAAKC,QAA5B,EAAsCE,EAAtC,EAA0CJ,MAA1C,CAAd,CAAP;AACD,KAED,EAAO,UAACM,GAAD,EAAiB;AAAA,qBAAb,UAAa;;AAAA;;AACtB,UAAIC,aAAaZ,OAAOa,IAAP,CAAYF,IAAIG,IAAhB,EAAsBH,IAAIJ,QAA1B,CAAjB;;AAEA,UAAI,CAACK,UAAL,EAEE,MADAD,IAAII,MAAJ,GAAa,GACb,EAAM,IAAIC,KAAJ,CAAW,oBAAmBL,IAAIG,IAAK,EAAvC,CAAN;;AAKF,aAFAH,IAAIM,KAAJ,GAAYL,UAEZ,EAAOA,WAAWM,GAAX,CAAeP,GAAf,CAAP;AACD,KAXD;AAYD,GAvBD;AAwBD","file":"index.js","sourcesContent":["import type { RouterType } from 'router-segments';\n\ntype AppType = any;\ntype ReturnType = (app: AppType) => (ctx: Object) => Promise<void>;\n\nexport default function alpRouter(router: RouterType): ReturnType {\n  return (app: AppType) => {\n    app.router = router;\n\n    app.context.urlGenerator = function(routeKey: string, params: any): string {\n      return router.toLocalizedPath(this.language, routeKey, params);\n    };\n\n    app.context.redirectTo = function(to: string, params: any): any {\n      return this.redirect(router.toLocalizedPath(this.language, to, params));\n    };\n\n    return (ctx: Object) => {\n      let routeMatch = router.find(ctx.path, ctx.language);\n\n      if (!routeMatch) {\n        ctx.status = 404;\n        throw new Error(`Route not found: ${ctx.path}`);\n      }\n\n      ctx.route = routeMatch;\n\n      return routeMatch.ref(ctx);\n    };\n  };\n}\n"]}