{"version":3,"sources":["../../../src/services/user/userAccountGoogleService.js"],"names":["UserAccountGoogleService","providerKey","getProfile","tokens","fetch","accessToken","then","response","json","isAccount","account","profile","googleId","id","getId","getAccountName","email","getEmails","plusProfile","emails","push","forEach","indexOf","value","getDisplayName","name","getFullName","givenName","given_name","familyName","family_name","getDefaultScope","newScope","getScope","oldScope","split","concat","filter","item","i","ar","scopeKeyToScope","login"],"mappings":";;;;;;oBAAA;;;AACA;;;;;;kBAEe,uBAAI,MAAMA,wBAAN,0BAAoD;AAAA;AAAA;;AAAA,6CAKrEC,WALqE,GAKvD,QALuD;AAAA;;AAOrEC,aAAWC,MAAX,EAAmB;AACjB,WAAOC,MAAO,+DAA6DD,OAAOE,WAAY,GAAvF,EACEC,IADF,CACQC,QAAD,IAAcA,SAASC,IAAT,EADrB,CAAP;AAED;;AAEDC,YAAUC,OAAV,EAAmBC,OAAnB,EAA4B;AAC1B,WAAOD,QAAQE,QAAR,KAAqBD,QAAQE,EAApC;AACD;;AAEDC,QAAMH,OAAN,EAAe;AACb,WAAOA,QAAQE,EAAf;AACD;;AAEDE,iBAAeJ,OAAf,EAAwB;AACtB,WAAOA,QAAQK,KAAf;AACD;;AAEDC,YAAUN,OAAV,EAAmBO,WAAnB,EAAgC;AAC9B,UAAMC,SAAS,EAAf;;AAEA,QAAIR,QAAQK,KAAZ,EAAmB;AACjBG,aAAOC,IAAP,CAAYT,QAAQK,KAApB;AACD;;AAED,QAAIE,YAAYC,MAAhB,EAAwB;AACtBD,kBAAYC,MAAZ,CAAmBE,OAAnB,CAA4BL,KAAD,IAAW;AACpC,YAAIG,OAAOG,OAAP,CAAeN,MAAMO,KAArB,QAAJ,EAAwC;AACtCJ,iBAAOC,IAAP,CAAYJ,MAAMO,KAAlB;AACD;AACF,OAJD;AAKD;;AAED,WAAOJ,MAAP;AACD;;AAEDK,iBAAeb,OAAf,EAAwB;AACtB,WAAOA,QAAQc,IAAf;AACD;;AAEDC,cAAYf,OAAZ,EAAqB;AACnB,WAAO;AACLgB,iBAAWhB,QAAQiB,UADd;AAELC,kBAAYlB,QAAQmB;AAFf,KAAP;AAID;;AAEDC,kBAAgBC,QAAhB,EAA0B;AACxB,WAAO,KAAKC,QAAL,CAAcD,QAAd,CAAP;AACD;;AAEDC,WAASC,QAAT,EAAmBF,QAAnB,EAA6B;AAC3B,WAAO,CAACE,QAAD,GAAYF,SAASG,KAAT,CAAe,GAAf,CAAZ,GAAkCD,SAASE,MAAT,CAAgBJ,SAASG,KAAT,CAAe,GAAf,CAAhB,EAChCE,MADgC,CACzB,CAACC,IAAD,EAAOC,CAAP,EAAUC,EAAV,KAAiBA,GAAGlB,OAAH,CAAWgB,IAAX,MAAqBC,CADb,CAAzC;AAED;AA5DoE,CAAxD,SACNE,eADM,GACY;AACvBC,SAAO;AADgB,CADZ,W","file":"userAccountGoogleService.js","sourcesContent":["/* global fetch */\nimport EventEmitter from 'events';\n\nexport default new class UserAccountGoogleService extends EventEmitter {\n  static scopeKeyToScope = {\n    login: 'openid profile email https://www.googleapis.com/auth/plus.profile.emails.read',\n  };\n\n  providerKey = 'google';\n\n  getProfile(tokens) {\n    return fetch(`https://www.googleapis.com/oauth2/v1/userinfo?access_token=${tokens.accessToken}`)\n            .then((response) => response.json());\n  }\n\n  isAccount(account, profile) {\n    return account.googleId === profile.id;\n  }\n\n  getId(profile) {\n    return profile.id;\n  }\n\n  getAccountName(profile) {\n    return profile.email;\n  }\n\n  getEmails(profile, plusProfile) {\n    const emails = [];\n\n    if (profile.email) {\n      emails.push(profile.email);\n    }\n\n    if (plusProfile.emails) {\n      plusProfile.emails.forEach((email) => {\n        if (emails.indexOf(email.value) === -1) {\n          emails.push(email.value);\n        }\n      });\n    }\n\n    return emails;\n  }\n\n  getDisplayName(profile) {\n    return profile.name;\n  }\n\n  getFullName(profile) {\n    return {\n      givenName: profile.given_name,\n      familyName: profile.family_name,\n    };\n  }\n\n  getDefaultScope(newScope) {\n    return this.getScope(newScope);\n  }\n\n  getScope(oldScope, newScope) {\n    return !oldScope ? newScope.split(' ') : oldScope.concat(newScope.split(' '))\n            .filter((item, i, ar) => ar.indexOf(item) === i);\n  }\n}();\n"]}