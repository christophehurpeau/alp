{"version":3,"sources":["../src/index.js"],"names":["PropTypes","Component","connect","SubscribeContainerComponent","componentDidMount","props","dispatch","name","websocket","context","app","_handlerConnected","on","emit","then","action","isConnected","componentWillUnmount","off","render","children","propTypes","func","isRequired","string","node","contextTypes","object"],"mappings":"AAAA,SAASA,SAAT,EAAoBC,SAApB,QAAqC,OAArC;AACA,SAASC,OAAT,QAAwB,iBAAxB;;AAEA,MAAMC,2BAAN,SAA0CF,SAA1C,CAAoD;;AAWlDG,sBAAoB;AAAA,iBACS,KAAKC,KADd;AAAA,QACVC,QADU,UACVA,QADU;AAAA,QACAC,IADA,UACAA,IADA;AAAA,QAEQC,SAFR,GAE0B,KAAKC,OAF/B,CAEVA,OAFU,CAECC,GAFD,CAEQF,SAFR;;AAGlB,SAAKG,iBAAL,GAAyBH,UAAUI,EAAV,CAAa,SAAb,EAAwB,MAAM;AACrDJ,gBAAUK,IAAV,CAAgB,cAAYN,IAAK,GAAjC,EACGO,IADH,CACQC,UAAUA,UAAUT,SAASS,MAAT,CAD5B;AAED,KAHwB,CAAzB;AAIA,QAAIP,UAAUQ,WAAV,EAAJ,EAA6B;AAC3B,WAAKL,iBAAL;AACD;AACF;;AAEDM,yBAAuB;AAAA,QACbV,IADa,GACJ,KAAKF,KADD,CACbE,IADa;AAAA,QAEbE,OAFa,GAED,KAAKA,OAFJ,CAEbA,OAFa;;AAGrB,QAAMD,YAAYC,QAAQC,GAAR,CAAYF,SAA9B;AACA,QAAIA,UAAUQ,WAAV,EAAJ,EAA6B;AAC3BR,gBAAUK,IAAV,CAAgB,gBAAcN,IAAK,GAAnC;AACD;;AAEDC,cAAUU,GAAV,CAAc,SAAd,EAAyB,KAAKP,iBAA9B;AACD;;AAEDQ,WAAS;AACP,WAAO,KAAKd,KAAL,CAAWe,QAAlB;AACD;AApCiD;;AAA9CjB,2B,CACGkB,S,GAAY;AACjBf,YAAUN,UAAUsB,IAAV,CAAeC,UADR;AAEjBhB,QAAMP,UAAUwB,MAAV,CAAiBD,UAFN;AAGjBH,YAAUpB,UAAUyB;AAHH,C;AADftB,2B,CAOGuB,Y,GAAe;AACpBjB,WAAST,UAAU2B;AADC,C;AAgCxB,eAAezB,UAAUC,2BAAV,CAAf","file":"index.js","sourcesContent":["import { PropTypes, Component } from 'react';\nimport { connect } from 'alp-react-redux';\n\nclass SubscribeContainerComponent extends Component {\n  static propTypes = {\n    dispatch: PropTypes.func.isRequired,\n    name: PropTypes.string.isRequired,\n    children: PropTypes.node,\n  };\n\n  static contextTypes = {\n    context: PropTypes.object,\n  };\n\n  componentDidMount() {\n    const { dispatch, name } = this.props;\n    const { context: { app: { websocket } } } = this.context;\n    this._handlerConnected = websocket.on('connect', () => {\n      websocket.emit(`subscribe:${name}`)\n        .then(action => action && dispatch(action));\n    });\n    if (websocket.isConnected()) {\n      this._handlerConnected();\n    }\n  }\n\n  componentWillUnmount() {\n    const { name } = this.props;\n    const { context } = this.context;\n    const websocket = context.app.websocket;\n    if (websocket.isConnected()) {\n      websocket.emit(`unsubscribe:${name}`);\n    }\n\n    websocket.off('connect', this._handlerConnected);\n  }\n\n  render() {\n    return this.props.children;\n  }\n}\n\nexport default connect()(SubscribeContainerComponent);\n"]}