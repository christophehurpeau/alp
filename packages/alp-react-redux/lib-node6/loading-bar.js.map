{"version":3,"sources":["../src/loading-bar.js"],"names":[],"mappings":";;;;;kBAyBwB,U;AAzBxB;;AAEA,SAAS,MAAT,GAAkB;AAChB,SAAO,KAAK,IAAL,CAAU,KAAK,MAAL,KAAgB,GAA1B,IAAiC,GAAxC;AACD;;AAED;;;;;;AAMA,SAAS,gBAAT,CAA0B,OAA1B,EAAmC;AACjC,MAAI,UAAU,EAAd,EAAkB;AAChB,WAAO,UAAW,WAAW,EAAtB,GAA4B,EAAnC;AACD,GAFD,MAEO,IAAI,UAAU,EAAd,EAAkB;AACvB,WAAO,UAAU,QAAV,GAAqB,GAA5B;AACD,GAFM,MAEA,IAAI,UAAU,EAAd,EAAkB;AACvB,WAAO,UAAU,GAAjB;AACD,GAFM,MAEA;AACL,WAAO,OAAP;AACD;AACF;;AAED,IAAI,UAAU,IAAd;AACe,SAAS,UAAT,GAAsB;AACnC,MAAI,OAAJ,EAAa,MAAM,IAAI,KAAJ,CAAU,iBAAV,CAAN;AACb,YAAU,IAAV;;AAEA,QAAM,aAAa,SAAS,cAAT,CAAwB,aAAxB,CAAnB;AACA,QAAM,qBAAqB,WAAW,iBAAtC;AACA,qBAAmB,KAAnB,CAAyB,KAAzB,GAAiC,IAAjC;AACA,qBAAmB,KAAnB,CAAyB,UAAzB,GAAsC,OAAtC;AACA,aAAW,KAAX,CAAiB,OAAjB,GAA2B,OAA3B;;AAEA,MAAI,UAAU,EAAd;AACA,QAAM,iBAAiB,WAAW,MAAM;AACtC,uBAAmB,KAAnB,CAAyB,KAAzB,GAAiC,KAAjC;AACD,GAFsB,EAEpB,GAFoB,CAAvB;;AAIA,QAAM,gBAAgB,YAAY,MAAM;AACtC,uBAAmB,KAAnB,CAAyB,KAAzB,GAAkC,IAAE,UAAU,iBAAiB,OAAjB,CAA0B,IAAxE;AACD,GAFqB,EAEnB,GAFmB,CAAtB;;AAIA,SAAO,MAAM;AACX,iBAAa,cAAb;AACA,kBAAc,aAAd;AACA,uBAAmB,KAAnB,CAAyB,KAAzB,GAAiC,MAAjC;AACA,uBAAmB,KAAnB,CAAyB,UAAzB,GAAsC,EAAtC;AACA,eAAW,KAAX,CAAiB,UAAjB,GAA8B,SAA9B;AACA,cAAU,KAAV;;AAEA,eAAW,MAAM;AACf,UAAI,CAAC,OAAL,EAAc;AACZ,mBAAW,KAAX,CAAiB,OAAjB,GAA2B,MAA3B;AACA,mBAAW,KAAX,CAAiB,UAAjB,GAA8B,EAA9B;AACD;AACF,KALD,EAKG,GALH;AAMD,GAdD;AAeD","file":"loading-bar.js","sourcesContent":["/* global document */\n\nfunction random() {\n  return Math.ceil(Math.random() * 100) / 100;\n}\n\n/**\n * around:\n * 1s for 60%\n * 4s for 80%\n * 6s for 95%\n */\nfunction calculatePercent(percent) {\n  if (percent < 60) {\n    return percent + (random() * 10) + 20;\n  } else if (percent < 80) {\n    return percent + random() + 0.5;\n  } else if (percent < 95) {\n    return percent + 0.1;\n  } else {\n    return percent;\n  }\n}\n\nlet loading = null;\nexport default function loadingBar() {\n  if (loading) throw new Error('Already loading');\n  loading = true;\n\n  const loadingBar = document.getElementById('loading-bar');\n  const loadingBarProgress = loadingBar.firstElementChild;\n  loadingBarProgress.style.width = '1%';\n  loadingBarProgress.style.willChange = 'width';\n  loadingBar.style.display = 'block';\n\n  let percent = 20;\n  const first20Timeout = setTimeout(() => {\n    loadingBarProgress.style.width = '20%';\n  }, 100);\n\n  const progressTimer = setInterval(() => {\n    loadingBarProgress.style.width = `${percent = calculatePercent(percent)}%`;\n  }, 500);\n\n  return () => {\n    clearTimeout(first20Timeout);\n    clearInterval(progressTimer);\n    loadingBarProgress.style.width = '100%';\n    loadingBarProgress.style.willChange = '';\n    loadingBar.style.willChange = 'display';\n    loading = false;\n\n    setTimeout(() => {\n      if (!loading) {\n        loadingBar.style.display = 'none';\n        loadingBar.style.willChange = '';\n      }\n    }, 500);\n  };\n}\n"]}