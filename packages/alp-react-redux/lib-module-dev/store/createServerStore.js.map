{"version":3,"sources":["../../src/store/createServerStore.js"],"names":["combineReducers","createStore","identityReducer","ctx","moduleReducers","sharedReducers","initialContext","computeInitialContextForBrowser","state","keys","Object","initialContextReducers","create","forEach","key","rootReducer","app","alpReducers","module"],"mappings":";;AAAA,SAASA,eAAT,EAA0BC,WAA1B;AACA,OAAOC,eAAP,MAA4B,0BAA5B;;AAEA,gBAAe,2BAACC,GAAD,EAAMC,cAAN,QAA6C;AAAA,MAArBC,cAAqB,QAArBA,cAAqB;;AAC1D;AACA,MAAMC,iBAAiBH,IAAII,+BAAJ,GAAsCC,KAA7D;AACA,MAAMC,OAAOC,OAAOD,IAAP,CAAYH,cAAZ,CAAb;AACA,MAAMK,yBAAyBD,OAAOE,MAAP,CAAc,IAAd,CAA/B;AACAH,OAAKI,OAAL,CAAa;AAAA,WAAQF,uBAAuBG,GAAvB,IAA8BZ,eAAtC;AAAA,GAAb;;AAEAI,iBAAeH,GAAf,GAAqBA,GAArB;;AAEA,MAAMY,cAAcf,6BACfW,sBADe,EAEfR,IAAIa,GAAJ,CAAQC,WAFO,EAGfZ,cAHe;AAIlBF,SAAKD,eAJa;AAKlBgB,YAAQd,iBAAiBJ,gBAAgBI,cAAhB,CAAjB,GAAmDF;AALzC,KAApB;;AAQA,SAAOD,YAAYc,WAAZ,EAAyBT,cAAzB,CAAP;AACD,CAlBD","file":"createServerStore.js","sourcesContent":["import { combineReducers, createStore } from 'redux/src';\nimport identityReducer from '../utils/identityReducer';\n\nexport default (ctx, moduleReducers, { sharedReducers }) => {\n  // TODO create new API ?\n  const initialContext = ctx.computeInitialContextForBrowser().state;\n  const keys = Object.keys(initialContext);\n  const initialContextReducers = Object.create(null);\n  keys.forEach(key => (initialContextReducers[key] = identityReducer));\n\n  initialContext.ctx = ctx;\n\n  const rootReducer = combineReducers({\n    ...initialContextReducers,\n    ...ctx.app.alpReducers,\n    ...sharedReducers,\n    ctx: identityReducer,\n    module: moduleReducers ? combineReducers(moduleReducers) : identityReducer,\n  });\n\n  return createStore(rootReducer, initialContext);\n};\n"]}