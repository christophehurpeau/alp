{"version":3,"sources":["../src/createLoader.js"],"names":[],"mappings":";;AAAA;AACA,eAAe,SAAS,YAAT,CAAsB,YAAtB,EAAqD,QAArD,EAAwE;AACrF,MAAI,QAAO,YAAP,yCAAO,YAAP,OAAwB,QAA5B,EAAsC;AACpC,eAAW,YAAX;AACA,mBAAe;AAAA,aAAO,EAAP;AAAA,KAAf;AACD;;AAED,MAAM,aAAa,IAAI,GAAJ,CAAQ,OAAO,IAAP,CAAY,QAAZ,EAAsB,GAAtB,CAA0B;AAAA,WAAO,CAAC,GAAD,EAAM,SAAS,GAAT,CAAN,CAAP;AAAA,GAA1B,CAAR,CAAnB;AACA,aAAW,SAAX;;AAEA,SAAO,YAAkC;AAAA,QAAjC,KAAiC,yDAAzB,cAAyB;AAAA,QAAT,IAAS;;AACvC,QAAM,OAAO,OAAO,IAAP,CAAY,IAAZ,CAAb;AACA,WAAO,QAAQ,GAAR,CAAY,KAAK,GAAL,CAAS,eAAO;AACjC,UAAM,UAAU,WAAW,GAAX,CAAe,GAAf,CAAhB;;AAEA,aAAO,QAAQ,KAAR,EAAe,KAAK,GAAL,CAAf,CAAP;AACD,KAJkB,CAAZ,EAIH,IAJG,CAIE,mBAAW;AAClB,cAAQ,OAAR,CAAgB,UAAC,MAAD,EAAS,KAAT,EAAmB;AACjC,cAAM,KAAK,KAAL,CAAN,IAAqB,MAArB;AACD,OAFD;AAGA,aAAO,KAAP;AACD,KATM,CAAP;AAUD,GAZD;AAaD","file":"createLoader.js","sourcesContent":["/* global PRODUCTION */\nexport default function createLoader(defaultState: Function|Object, handlers: ?Object) {\n  if (typeof defaultState === 'object') {\n    handlers = defaultState;\n    defaultState = () => ({});\n  }\n\n  const handlerMap = new Map(Object.keys(handlers).map(key => [key, handlers[key]]));\n  handlers = undefined;\n\n  return (state = defaultState(), data) => {\n    const keys = Object.keys(data);\n    return Promise.all(keys.map(key => {\n      const handler = handlerMap.get(key);\n      if (!PRODUCTION && !handler) throw new Error(`Missing handler for \"${key}\".`);\n      return handler(state, data[key]);\n    })).then(results => {\n      results.forEach((result, index) => {\n        state[keys[index]] = result;\n      });\n      return state;\n    });\n  };\n}\n"]}