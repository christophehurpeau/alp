{"version":3,"sources":["../../src/store/createBrowserModuleStoreReducer.js"],"names":["combineReducers","MODULE_INIT_TYPE","initialReducers","_reducers","combinedReducers","state","reducer","action","type","undefined","set","store","reducers","console","log","Promise","resolve","setImmediate","dispatch"],"mappings":"AAAA,SAASA,eAAT;;AAEA,MAAMC,mBAAmB,yBAAzB;;AAEA;AACA;AACA;AACA;;AAEA,gBAAe,UAACC,eAAD,EAA6B;AAC1C,MAAIC,YAAYD,eAAhB;AACA,MAAIE,mBAAmBF,kBAAkBF,gBAAgBE,eAAhB,CAAlB,GAAqD;AAAA,WAASG,KAAT;AAAA,GAA5E;AACA,SAAO;AACLC,aAAS,iBAACD,KAAD,EAAQE,MAAR;AAAA,aACPH,iBAAiBG,OAAOC,IAAP,KAAgBP,gBAAhB,GAAmCQ,SAAnC,GAA+CJ,KAAhE,EAAuEE,MAAvE,CADO;AAAA,KADJ;;AAILG,SAAK,aAACC,KAAD,EAAQC,QAAR,EAAqB;AACxB,UAAIA,aAAaT,SAAjB,EAA4B,OAAO,KAAP;AAC5BU,cAAQC,GAAR,CAAY,cAAZ,EAA4BF,QAA5B,EAAsCT,SAAtC;AACA,aAAO,IAAIY,OAAJ,CAAY,UAACC,OAAD,EAAqB;AACtCC,qBAAa,YAAM;AACjBd,sBAAYS,QAAZ;AACAR,6BAAmBJ,gBAAgBY,QAAhB,CAAnB;AACAD,gBAAMO,QAAN,CAAe,EAAEV,MAAMP,gBAAR,EAAf;AACAe;AACD,SALD;AAMD,OAPM,CAAP;AAQD;AAfI,GAAP;AAiBD,CApBD","file":"createBrowserModuleStoreReducer.js","sourcesContent":["import { combineReducers } from 'redux/src';\n\nconst MODULE_INIT_TYPE = '@@alp-redux/INIT_MODULE';\n\n// https://github.com/insin/react-examples/tree/master/code-splitting-redux-reducers\n// https://medium.com/@luigiplr/react-redux-react-router-4-code-splitting-w-rxjs-webpack-32eabedf0e9\n// https://gist.github.com/gaearon/0a2213881b5d53973514\n// https://github.com/zeit/next.js/pull/1459\n\nexport default (initialReducers: Object) => {\n  let _reducers = initialReducers;\n  let combinedReducers = initialReducers ? combineReducers(initialReducers) : state => state;\n  return {\n    reducer: (state, action) =>\n      combinedReducers(action.type === MODULE_INIT_TYPE ? undefined : state, action),\n\n    set: (store, reducers) => {\n      if (reducers === _reducers) return false;\n      console.log('set reducers', reducers, _reducers);\n      return new Promise((resolve, reject) => {\n        setImmediate(() => {\n          _reducers = reducers;\n          combinedReducers = combineReducers(reducers);\n          store.dispatch({ type: MODULE_INIT_TYPE });\n          resolve();\n        });\n      });\n    },\n  };\n};\n"]}