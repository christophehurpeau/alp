{"version":3,"file":"index-browsermodern.es.js","sources":["../src/createAlpAppWrapper.jsx","../src/utils/identityReducer.js","../src/store/middleware-browser.js","../src/store/createBrowserStore.js","../src/store/createBrowserModuleStoreReducer.js","../src/module/AlpModule.jsx","../src/module/createModuleVisitor.js","../src/utils/createAction.js","../src/utils/createReducer.js","../src/utils/createLoader.js","../src/utils/createPureStatelessComponent.js","../src/utils/classNames.js","../src/module/AlpReduxModuleBrowser.jsx","../src/layout/Body.jsx","../src/layout/AppContainer.jsx","../src/browser.js"],"sourcesContent":["import { Component, type Element } from 'react';\nimport PropTypes from 'prop-types';\n\ntype PropsType = {||};\n\nexport default (app: Element, context: Object) =>\n  class AlpAppWrapper extends Component {\n    props: PropsType;\n\n    static childContextTypes = {\n      context: PropTypes.object.isRequired,\n      store: PropTypes.object.isRequired,\n      setModuleReducers: PropTypes.func,\n    };\n\n    state = {\n      error: null,\n    };\n\n    getChildContext(): Object {\n      return context;\n    }\n\n    componentDidCatch(error, errorInfo) {\n      this.setState({ error });\n      console.error(error, errorInfo);\n      if (window.Raven) window.Raven.captureException(error, { extra: errorInfo });\n    }\n\n    render(): Element {\n      if (this.state.error) return <div>An unexpected error occured</div>;\n      return app;\n    }\n  };\n","export default (state = null) => state;\n","export const promiseMiddleware = store => next => action => {\n  if (typeof action.then !== 'function') {\n    return next(action);\n  }\n\n  return Promise.resolve(action).then(store.dispatch);\n};\n\nexport const createFunctionMiddleware = app => store => next => action => {\n  if (typeof action !== 'function') {\n    return next(action);\n  }\n\n  return action(store.dispatch, app);\n};\n","import { createStore, applyMiddleware, compose, combineReducers } from 'redux/src';\nimport identityReducer from '../utils/identityReducer';\nimport { promiseMiddleware, createFunctionMiddleware } from './middleware-browser';\n\nexport default (app, ctx, moduleReducer, { middlewares, sharedReducers }) => {\n  const reducers = {\n    ...app.reduxReducers,\n    ...sharedReducers,\n    ctx: identityReducer,\n    module: moduleReducer,\n  };\n\n  if (!PRODUCTION) {\n    Object.keys(reducers).forEach(key => {\n      if (typeof reducers[key] !== 'function') throw new Error(`Invalid reducer ${key}`);\n    });\n  }\n\n  const rootReducer = combineReducers(reducers);\n\n  const composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n\n  middlewares = [\n    createFunctionMiddleware(app),\n    promiseMiddleware,\n    ...app.reduxMiddlewares,\n    ...middlewares,\n  ];\n\n  return createStore(\n    rootReducer,\n    { ctx, ...window.__INITIAL_DATA__ },\n    composeEnhancers(applyMiddleware(...middlewares)),\n  );\n};\n","import { combineReducers } from 'redux/src';\nimport type { ReducerDictionaryType } from '../types';\n\nconst MODULE_INIT_TYPE = '@@alp-redux/INIT_MODULE';\n\n// https://github.com/insin/react-examples/tree/master/code-splitting-redux-reducers\n// https://medium.com/@luigiplr/react-redux-react-router-4-code-splitting-w-rxjs-webpack-32eabedf0e9\n// https://gist.github.com/gaearon/0a2213881b5d53973514\n// https://github.com/zeit/next.js/pull/1459\n\nconst createModuleReducer = (reducers: ?ReducerDictionaryType) =>\n  reducers ? combineReducers(reducers) : (state = null) => state;\n\nexport default (initialReducers: ?ReducerDictionaryType) => {\n  let _reducers = initialReducers;\n  let moduleReducer = createModuleReducer(initialReducers);\n  return {\n    reducer: (state, action) =>\n      moduleReducer(action.type === MODULE_INIT_TYPE ? undefined : state, action),\n\n    set: (store, reducers) => {\n      if (reducers === _reducers) return false;\n      return new Promise((resolve, reject) => {\n        setImmediate(() => {\n          _reducers = reducers;\n          moduleReducer = createModuleReducer(reducers);\n          store.dispatch({ type: MODULE_INIT_TYPE });\n          resolve();\n        });\n      });\n    },\n  };\n};\n","import { Component, type Node } from 'react';\n\ntype PropsType = {|\n  children: Node,\n|};\n\nexport default class AlpModule extends Component {\n  props: PropsType;\n\n  render(): Node {\n    if (!PRODUCTION) {\n      // eslint-disable-next-line react/prop-types\n      if (this.props.reducers) {\n        throw new Error('You have reducers, probably want to use AlpReduxModule.');\n      }\n    }\n    return this.props.children;\n  }\n}\n","// import AppContainer from '../layout/AppContainer';\nimport AlpModule from './AlpModule';\n\nexport default () => {\n  let reducers;\n\n  return {\n    visitor: (element, instance, context) => {\n      // console.log(element, instance, instance instanceof AlpModule, element.type === AppContainer);\n\n      if (instance && instance instanceof AlpModule) {\n        // eslint-disable-next-line prefer-destructuring\n        reducers = instance.props.reducers;\n        return false;\n      }\n\n      return true;\n    },\n\n    getReducers: () => reducers,\n  };\n};\n","// eslint-disable-next-line flowtype/no-weak-types\ntype HandlerType = (...args: Array<any>) => Object;\n\nexport default (type: string, handler: ?HandlerType) => {\n  const action = !handler ? () => ({ type }) : (...args) => ({ type, ...handler(...args) });\n  action.type = type;\n  action.toString = () => type;\n  return action;\n};\n","/* global PRODUCTION */\n\nexport default function createReducer(defaultState: Function | Object, handlers: ?Object) {\n  if (typeof defaultState === 'object') {\n    handlers = defaultState;\n    defaultState = () => null;\n  }\n\n  const handlerMap = new Map();\n  Object.keys(handlers).forEach(key => {\n    if (typeof key === 'function') {\n      if (!PRODUCTION && typeof key.type !== 'string') {\n        throw new Error(`Invalid handler key: \"${key.name}\"`);\n      }\n      handlerMap.set(key.type, handlers[key]);\n    } else {\n      handlerMap.set(key, handlers[key]);\n    }\n  });\n  handlers = undefined;\n\n  return (state = defaultState(), action) => {\n    if (action && handlerMap.has(action.type)) {\n      return handlerMap.get(action.type)(state, action);\n    }\n\n    return state;\n  };\n}\n","/* global PRODUCTION */\nexport default function createLoader(handlers: ?Object) {\n  const handlerMap = new Map(Object.keys(handlers).map(key => [key, handlers[key]]));\n  handlers = undefined;\n\n  return (state, data) => {\n    const keys = Object.keys(data);\n    return Promise.all(\n      keys.map(key => {\n        const handler = handlerMap.get(key);\n        if (!PRODUCTION && !handler) throw new Error(`Missing handler for \"${key}\".`);\n        return handler(state, data[key]);\n      }),\n    ).then(results => {\n      const data = Object.create(null);\n      results.forEach((result, index) => {\n        data[keys[index]] = result;\n      });\n      return data;\n    });\n  };\n}\n","import { connect } from 'react-redux';\n\n// mergeProps: remove dispatch from dispatchProps (and perf !)\nconst mergeProps = (stateProps, dispatchProps, ownProps) => ownProps;\n\nexport default Component => connect(null, null, mergeProps)(Component);\n","export default (...classNames) => classNames.filter(Boolean).join(' ');\n","import { type Node } from 'react';\nimport PropTypes from 'prop-types';\nimport type { ReducerDictionaryType } from '../types';\nimport AlpModule from './AlpModule';\n\ntype PropsType = {|\n  children: Node,\n  reducers: ?ReducerDictionaryType,\n|};\n\nexport default class AlpReduxModule extends AlpModule {\n  props: PropsType;\n\n  static contextTypes = {\n    setModuleReducers: PropTypes.func.isRequired,\n  };\n\n  constructor(props, context) {\n    super(props, context);\n    this.state = {\n      loading: this.setModuleReducers(props.reducers),\n    };\n  }\n\n  setModuleReducers(reducers) {\n    if (!this.context.setModuleReducers) return false; // pre render\n    const result = this.context.setModuleReducers(reducers);\n    if (result === false) return false;\n    result.then(() => {\n      this.setState({ loading: false });\n    });\n    return true;\n  }\n\n  componentWillReceiveProps(nextProps: PropTypes) {\n    if (nextProps.reducers !== this.props.reducers) {\n      this.setState({\n        loading: this.setModuleReducers(nextProps.reducers),\n      });\n    }\n  }\n\n  render(): Node {\n    return this.state.loading ? null : this.props.children;\n  }\n}\n","import { type Node } from 'react';\n\ntype Props = {| children: Node |};\n\nexport default ({ children }: Props) => <div>{children}</div>;\n","import type { Element, Node } from 'react';\n\ntype PropsType = {| children: Node |};\n\nexport default ({ children }: PropsType): Element<'div'> => <div>{children}</div>;\n","import contentLoaded from 'content-loaded';\nimport React from 'react';\nimport { hydrate } from 'react-dom';\nimport reactTreeWalker from 'react-tree-walker';\nimport Logger from 'nightingale-logger/src';\n// eslint-disable-next-line import/no-extraneous-dependencies\nimport BrowserAppContainer from 'alp-dev/BrowserAppContainer';\nimport createAlpAppWrapper from './createAlpAppWrapper';\nimport createBrowserStore from './store/createBrowserStore';\nimport createBrowserModuleStoreReducer from './store/createBrowserModuleStoreReducer';\nimport createModuleVisitor from './module/createModuleVisitor';\nimport type { ReduxActionType } from './types';\n\nexport Helmet from 'react-helmet';\nexport { combineReducers } from 'redux/src';\nexport { connect } from 'react-redux/src';\nexport {\n  createAction,\n  createReducer,\n  createLoader,\n  classNames,\n  createPureStatelessComponent,\n  identityReducer,\n} from './utils/index';\nexport AlpModule from './module/AlpModule';\nexport AlpReduxModule from './module/AlpReduxModuleBrowser';\nexport Body from './layout/Body';\nexport AppContainer from './layout/AppContainer';\n\nconst logger = new Logger('alp:react-redux');\n\nconst hydrateApp = App => hydrate(React.createElement(App), document.getElementById('react-app'));\n\nconst preRender = async function preRender(ctx, appElement) {\n  const moduleVisitor = createModuleVisitor();\n  const preRenderStore = { getState: () => ({ ctx }) };\n  const PreRenderWrappedApp = createAlpAppWrapper(appElement, {\n    context: ctx,\n    store: preRenderStore,\n  });\n  await reactTreeWalker(React.createElement(PreRenderWrappedApp), moduleVisitor.visitor);\n\n  return moduleVisitor.getReducers();\n};\n\nexport default app => {\n  app.reduxReducers = {\n    loading: (state: ?number = 0, action: ReduxActionType) => {\n      if (action.meta && action.meta.loading !== undefined) {\n        return state + (action.meta.loading ? 1 : -1);\n      }\n      return state;\n    },\n  };\n  app.reduxMiddlewares = [];\n\n  return {\n    renderApp: async function renderApp(App, { middlewares = [], sharedReducers } = {}) {\n      let store;\n      let moduleStoreReducer;\n\n      const createStore = (ctx, moduleReducers) => {\n        moduleStoreReducer = createBrowserModuleStoreReducer(moduleReducers);\n        const store = createBrowserStore(app, ctx, moduleStoreReducer.reducer, {\n          middlewares,\n          sharedReducers,\n        });\n        app.store = store;\n        window.store = store;\n        return store;\n      };\n\n      const ctx = app.createContext();\n\n      const render = async App => {\n        let appElement = React.createElement(App);\n        if (!PRODUCTION) {\n          appElement = React.createElement(BrowserAppContainer, {}, appElement);\n        }\n\n        const moduleReducers = await preRender(ctx, appElement);\n\n        if (!PRODUCTION) {\n          store = createStore(ctx, moduleReducers);\n        } else {\n          // in DEV\n          // eslint-disable-next-line no-lonely-if\n          if (!store) {\n            store = createStore(ctx, moduleReducers);\n          } else {\n            moduleStoreReducer.setReducers(moduleReducers);\n          }\n        }\n\n        const WrappedApp = createAlpAppWrapper(appElement, {\n          context: ctx,\n          store,\n          setModuleReducers: reducers => moduleStoreReducer.set(store, reducers),\n        });\n\n        await contentLoaded();\n        hydrateApp(WrappedApp);\n        logger.success('rendered');\n      };\n\n      await render(App);\n\n      return render;\n    },\n  };\n};\n"],"names":["app","context","Component","state","error","errorInfo","setState","window","Raven","captureException","extra","childContextTypes","PropTypes","object","isRequired","func","promiseMiddleware","action","then","next","Promise","resolve","store","dispatch","createFunctionMiddleware","ctx","moduleReducer","middlewares","sharedReducers","reducers","reduxReducers","identityReducer","rootReducer","combineReducers","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","reduxMiddlewares","createStore","__INITIAL_DATA__","applyMiddleware","MODULE_INIT_TYPE","createModuleReducer","initialReducers","_reducers","type","undefined","AlpModule","props","children","element","instance","handler","args","toString","createReducer","defaultState","handlers","handlerMap","Map","keys","forEach","key","set","has","get","createLoader","Object","map","data","all","create","result","index","mergeProps","stateProps","dispatchProps","ownProps","connect","classNames","filter","Boolean","join","AlpReduxModule","setModuleReducers","loading","nextProps","contextTypes","logger","Logger","hydrateApp","hydrate","React","createElement","App","document","getElementById","preRender","appElement","moduleVisitor","createModuleVisitor","PreRenderWrappedApp","createAlpAppWrapper","getState","reactTreeWalker","visitor","getReducers","meta","renderApp","moduleStoreReducer","moduleReducers","createBrowserModuleStoreReducer","createBrowserStore","reducer","createContext","render","setReducers","WrappedApp","contentLoaded","success"],"mappings":"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"}