{"version":3,"sources":["../src/compose.js"],"names":[],"mappings":";;;;;kBACwB,O;AADxB;AACe,SAAS,OAAT,CAAiB,UAAjB,EAA6B;AACxC,WAAO,UAAU,GAAV,EAAe,IAAf,EAAqB;AACxB,eAAQ,SAAS,QAAT,CAAkB,CAAlB,EAAqB;AACzB,gBAAM,KAAK,WAAW,CAAX,KAAiB,IAA5B;AACA,gBAAI,SAAS,KAAb;AACA,gBAAI;AACA,uBAAO,QAAQ,OAAR,CAAgB,GAAG,IAAH,CAAQ,GAAR,EAAa,GAAb,EAAkB,YAAM;AAC3C,wBAAI,MAAJ,EAAY,MAAM,IAAI,KAAJ,CAAU,oCAAV,CAAN;AACZ,6BAAS,IAAT;AACA,2BAAO,SAAS,IAAI,CAAb,CAAP;AACH,iBAJsB,CAAhB,CAAP;AAKH,aAND,CAME,OAAO,CAAP,EAAU;AACR,uBAAO,QAAQ,MAAR,CAAe,CAAf,CAAP;AACH;AACJ,SAZO,CAYN,CAZM,CAAR;AAaH,KAdD;AAeH","file":"compose.js","sourcesContent":["// create lib\nexport default function compose(middleware) {\n    return function (ctx, next) {\n        return (function dispatch(i) {\n            const fn = middleware[i] || next;\n            let called = false;\n            try {\n                return Promise.resolve(fn.call(ctx, ctx, () => {\n                    if (called) throw new Error('Cannot call next() more than once.');\n                    called = true;\n                    return dispatch(i + 1);\n                }));\n            } catch (e) {\n                return Promise.reject(e);\n            }\n        }(0));\n    };\n}\n"]}