{"version":3,"sources":["../src/index.js"],"names":[],"mappings":";;;;;;;;;;;;AAAA,OAAO,IAAP,MAAiB,MAAjB;AACA,OAAO,MAAP,MAAmB,YAAnB;AACA,OAAO,MAAP,MAAmB,oBAAnB;AACA;AACA,OAAO,QAAP,MAAqB,cAArB;AACA,OAAO,SAAP,MAAsB,eAAtB;AACA,OAAO,MAAP,MAAmB,YAAnB;AACA,OAAO,aAAP,MAA0B,gBAA1B;AACA,SAAS,QAAQ,UAAjB,EAA6B,QAA7B;;AAEA,SAAS,WAAW,aAApB,QAAyC,gBAAzC;;IAEqB,U;;;AAIjB;;;;AAIA,0BAAsC;AAAA,YAA1B,IAA0B,yDAAnB,GAAmB;AAAA,YAAd,OAAc,yDAAJ,EAAI;;AAAA;;AAAA;;AAElC,cAAK,IAAL,GAAY,IAAZ;;AAFkC,qBAElC,MAAK,IAF6B;AAAA,oHAElC,MAAK,IAF6B;AAAA;;AAIlC,YAAI,OAAO,mBAAX,EAAgC;AAC5B,kBAAK,OAAL,CAAa,KAAb,GAAqB,OAAO,mBAA5B;AACH;AANiC;AAOrC;;;;;;;;;;;uCAGS,OAAO,SAAP,EAAkB,IAAlB,C;;;AACN,yCAAS,IAAT;;uCACM,UAAU,UAAV,EAAsB,IAAtB,C;;;;;;;;;;;;;;;;;;qCAOG,a,EAAe,W,EAAa;AACrC,mBAAO,OAAO,aAAP,EAAsB,WAAtB,EAAmC,IAAnC,CAAP;AACH;;;sCAEa;AACV,iBAAK,GAAL,CAAS,MAAT;AACH;;;kCAES,a,EAAe,W,EAAa;AAClC,iBAAK,GAAL,CAAS,KAAK,YAAL,CAAkB,aAAlB,EAAiC,WAAjC,CAAT;AACH;;;sCAEa,gB,EAAkB,I,EAAM;AAAA;;AAClC,gBAAM,UAAU,OAAO,MAAP,CAAc,KAAK,OAAnB,CAAhB;;AAEA,mBAAO,gBACF,IADE,CACG;AAAA,uBACF,QAAQ,MAAR,CAAe,gBAAf,EAAiC,IAAjC,EAAuC,IAAvC,CADE;AAAA,aADH,EAGA,IAHA,CAGK,YAAM;AACV,uBAAK,EAAL,CAAQ,UAAR,EAAoB,QAApB;AACA,2BAAW;AAAA,2BAAO,OAAK,IAAL,CAAU,GAAV,CAAP;AAAA,iBAAX;AACH,aANE,CAAP;AAOH;;;4BA1BiB;AACd,mBAAO,KAAK,GAAZ;AACH;;;;EAzBmC,I;;eAAnB,U","file":"index.js","sourcesContent":["import Ibex from 'ibex';\nimport config from 'alp-config';\nimport errors from 'alp-errors-browser';\n// import params from 'alp-params-browser';\nimport language from 'alp-language';\nimport translate from 'alp-translate';\nimport router from 'alp-limosa';\nimport contentLoaded from 'content-loaded';\nimport { init as initWebApp, redirect } from 'alauda/src/web-app';\n\nexport { default as newController } from 'alp-controller';\n\nexport default class AlpBrowser extends Ibex {\n    path: string;\n    appVersion: string;\n\n    /**\n     * @param {string} [path='/']\n     * @param {Object} [options]\n     */\n    constructor(path = '/', options = {}) {\n        super();\n        this.path = path;\n\n        if (global.initialContextState) {\n            this.context.state = global.initialContextState;\n        }\n    }\n\n    async init() {\n        await config('/config')(this);\n        language(this);\n        await translate('/locales')(this);\n    }\n\n    get environment() {\n        return this.env;\n    }\n\n    createRouter(routerBuilder, controllers) {\n        return router(routerBuilder, controllers)(this);\n    }\n\n    catchErrors() {\n        this.use(errors);\n    }\n\n    useRouter(routerBuilder, controllers) {\n        this.use(this.createRouter(routerBuilder, controllers));\n    }\n\n    initialRender(moduleDescriptor, data) {\n        const context = Object.create(this.context);\n\n        return contentLoaded()\n            .then(() => (\n                context.render(moduleDescriptor, data, true)\n            )).then(() => {\n                this.on('redirect', redirect);\n                initWebApp(url => this.load(url));\n            });\n    }\n}\n"]}