{"version":3,"file":"index-browser.es.js","sources":["../src/index.ts"],"sourcesContent":["import Ibex from 'ibex';\nimport config, { getConfig, existsConfig } from 'alp-browser-config';\nimport language from 'alp-browser-language';\nimport translate from 'alp-translate/browser';\nimport Logger from 'nightingale-logger';\nimport { BrowserApplication, BrowserApplicationInCreation } from 'alp-types';\n\nconst logger = new Logger('alp');\n\ndeclare global {\n  interface Window {\n    __VERSION__: string;\n  }\n}\n\ninterface Options {\n  version?: string; // default to window.__VERSION__\n}\nconst configPath = '/config';\n\nexport default class AlpBrowser extends Ibex\n  implements BrowserApplicationInCreation {\n  path: string;\n\n  appVersion: string;\n\n  constructor(path = '/', { version = window.__VERSION__ }: Options = {}) {\n    super();\n    this.path = path;\n    this.appVersion = version;\n  }\n\n  async init(): Promise<BrowserApplication> {\n    await config(this, configPath);\n\n    language(this);\n    await translate('/locales')(this);\n\n    return (this as unknown) as BrowserApplication;\n  }\n\n  existsConfig(name: string) {\n    return existsConfig(`${configPath}${name}`);\n  }\n\n  loadConfig(name: string) {\n    return getConfig(`${configPath}${name}`);\n  }\n\n  start(fn: Function) {\n    try {\n      fn()\n        .then(() => logger.success('started'))\n        .catch((err: any) => logger.error('start fail', { err }));\n    } catch (err) {\n      logger.error('start fail', { err });\n    }\n  }\n}\n"],"names":["logger","Logger","configPath","AlpBrowser","path","version","window","__VERSION__","appVersion","init","config","language","translate","existsConfig","name","loadConfig","getConfig","start","fn","then","success","catch","err","error","Ibex"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOA,IAAMA,MAAM,GAAG,IAAIC,MAAJ,CAAW,KAAX,CAAf;AAWA,IAAMC,UAAU,GAAG,SAAnB;;IAEqBC;;;;;sBAMPC,IAAZ,SAAwE;;;QAA5DA,IAA4D;MAA5DA,IAA4D,GAArD,GAAqD;;;kCAAJ,EAAI;4BAA9CC,OAA8C;QAA9CA,OAA8C,6BAApCC,MAAM,CAACC,WAA6B;;;UAEjEH,IAAL,GAAYA,IAAZ;UACKI,UAAL,GAAkBH,OAAlB;;;;;;SAGII;;;;;;;;;;;qBACEC,MAAM,CAAC,IAAD,EAAOR,UAAP;;;cAEZS,QAAQ,CAAC,IAAD,CAAR;;qBACMC,SAAS,CAAC,UAAD,CAAT,CAAsB,IAAtB;;;+CAEE;;;;;;;;;;;;;;;SAGVC,wCAAaC,MAAc;WAClBD,YAAY,aAAiBC,IAAjB,CAAnB;;;SAGFC,iCAAWD,MAAc;WAChBE,SAAS,aAAiBF,IAAjB,CAAhB;;;SAGFG,uBAAMC,IAAc;QACd;MACFA,EAAE,GACCC,IADH,CACQ;eAAMnB,MAAM,CAACoB,OAAP,CAAe,SAAf,CAAN;OADR,EAEGC,KAFH,CAES,UAACC,GAAD;eAActB,MAAM,CAACuB,KAAP,CAAa,YAAb,EAA2B;UAAED,GAAG,EAAHA;SAA7B,CAAd;OAFT;KADF,CAIE,OAAOA,GAAP,EAAY;MACZtB,MAAM,CAACuB,KAAP,CAAa,YAAb,EAA2B;QAAED,GAAG,EAAHA;OAA7B;;;;;EAnCkCE;;;;"}