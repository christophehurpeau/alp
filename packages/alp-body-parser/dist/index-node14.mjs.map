{"version":3,"file":"index-node14.mjs","sources":["../src/index.ts"],"sourcesContent":["import parse from 'co-body';\n// eslint-disable-next-line @typescript-eslint/consistent-type-imports\nimport Application, { Context } from 'koa';\n\ndeclare module 'koa' {\n  interface Request {\n    body: any;\n  }\n\n  interface BaseContext {\n    parseBody: <T>() => Promise<T>;\n    parseBodyJson: <T>() => Promise<T>;\n    parseBodyText: <T>() => Promise<T>;\n  }\n}\n\nconst assertBodyNotParsed = (ctx: Context): void => {\n  if (ctx.request.body) {\n    throw new Error('Request is already parsed');\n  }\n};\n\nexport default function alpBodyParser(app: Application): void {\n  app.context.parseBody = async function <T>(this: Context): Promise<T> {\n    assertBodyNotParsed(this);\n    const body: T = (await parse.form(this)) as T;\n    this.request.body = body;\n    return body;\n  };\n\n  app.context.parseBodyJson = async function <T>(this: Context): Promise<T> {\n    assertBodyNotParsed(this);\n    const body: T = (await parse.json(this)) as T;\n    this.request.body = body;\n    return body;\n  };\n\n  app.context.parseBodyText = async function <T>(this: Context): Promise<T> {\n    assertBodyNotParsed(this);\n    const body: T = (await parse.text(this)) as T;\n    this.request.body = body;\n    return body;\n  };\n}\n"],"names":["assertBodyNotParsed","ctx","request","body","Error","alpBodyParser","app","context","parseBody","parse","form","parseBodyJson","json","parseBodyText","text"],"mappings":";;AAgBA,MAAMA,mBAAmB,GAAIC,GAAD,IAAwB;AAClD,MAAIA,GAAG,CAACC,OAAJ,CAAYC,IAAhB,EAAsB;AACpB,UAAM,IAAIC,KAAJ,CAAU,2BAAV,CAAN;AACD;AACF,CAJD;;AAMe,SAASC,aAAT,CAAuBC,GAAvB,EAA+C;AAC5DA,EAAAA,GAAG,CAACC,OAAJ,CAAYC,SAAZ,GAAwB,kBAA8C;AACpER,IAAAA,mBAAmB,CAAC,IAAD,CAAnB;AACA,UAAMG,IAAO,GAAI,MAAMM,KAAK,CAACC,IAAN,CAAW,IAAX,CAAvB;AACA,SAAKR,OAAL,CAAaC,IAAb,GAAoBA,IAApB;AACA,WAAOA,IAAP;AACD,GALD;;AAOAG,EAAAA,GAAG,CAACC,OAAJ,CAAYI,aAAZ,GAA4B,kBAA8C;AACxEX,IAAAA,mBAAmB,CAAC,IAAD,CAAnB;AACA,UAAMG,IAAO,GAAI,MAAMM,KAAK,CAACG,IAAN,CAAW,IAAX,CAAvB;AACA,SAAKV,OAAL,CAAaC,IAAb,GAAoBA,IAApB;AACA,WAAOA,IAAP;AACD,GALD;;AAOAG,EAAAA,GAAG,CAACC,OAAJ,CAAYM,aAAZ,GAA4B,kBAA8C;AACxEb,IAAAA,mBAAmB,CAAC,IAAD,CAAnB;AACA,UAAMG,IAAO,GAAI,MAAMM,KAAK,CAACK,IAAN,CAAW,IAAX,CAAvB;AACA,SAAKZ,OAAL,CAAaC,IAAb,GAAoBA,IAApB;AACA,WAAOA,IAAP;AACD,GALD;AAMD;;;;"}