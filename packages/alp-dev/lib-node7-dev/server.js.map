{"version":3,"sources":["../src/server.js"],"names":["watchServer","port","then","emitter","daemon","Date","now","process","on","stop","start","_restartTimeout","clearTimeout","args","length","restartTimeout"],"mappings":";;;;;kBAIwBA,W;;AAHxB;;AACA;;AAFA;AAIe,SAASA,WAAT,CAAqBC,IAArB,EAA2B;AACxC,SAAO,0BAAQC,IAAR,CAAcC,OAAD,IAAa;AAC/B,UAAMC,SAAS,6BAAW,CACxB,+BADwB,EAExB,QAFwB,EAGxBH,IAHwB,EAIxB,WAJwB,EAKvB,MAAKI,KAAKC,GAAL,EAAW,EALO,CAAX,CAAf;;AAQAC,YAAQC,EAAR,CAAW,MAAX,EAAmB,MAAM;AACvB,UAAIJ,MAAJ,EAAY;AACVA,eAAOK,IAAP;AACD;AACF,KAJD;;AAMAL,WAAOM,KAAP;;AAEA,QAAIC,eAAJ;AACAR,YAAQK,EAAR,CAAW,SAAX,EAAsB,MAAM;AAC1B,UAAIG,eAAJ,EAAqBC,aAAaD,eAAb;AACrBP,aAAOS,IAAP,CAAYT,OAAOS,IAAP,CAAYC,MAAZ,GAAqB,CAAjC,IAAuC,MAAKT,KAAKC,GAAL,EAAW,EAAvD;AACAK,wBAAkBP,OAAOW,cAAP,CAAsB,IAAtB,CAAlB;AACD,KAJD;AAKD,GAvBM,CAAP;AAwBD","file":"server.js","sourcesContent":["// const bsReload = require('./bs-reload');\nimport { node as nodeDaemon } from 'springbokjs-daemon/src';\nimport { watch } from './config-build';\n\nexport default function watchServer(port) {\n  return watch().then((emitter) => {\n    const daemon = nodeDaemon([\n      'lib-node6-dev/index.server.js',\n      '--port',\n      port,\n      '--version',\n      `dev${Date.now()}`,\n    ]);\n\n    process.on('exit', () => {\n      if (daemon) {\n        daemon.stop();\n      }\n    });\n\n    daemon.start();\n\n    let _restartTimeout;\n    emitter.on('changed', () => {\n      if (_restartTimeout) clearTimeout(_restartTimeout);\n      daemon.args[daemon.args.length - 1] = `dev${Date.now()}`;\n      _restartTimeout = daemon.restartTimeout(1000);\n    });\n  });\n}\n"]}