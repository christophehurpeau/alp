{"version":3,"sources":["../src/server.js"],"names":[],"mappings":";;AACA;;AACA;;;;AACA;;;;AAEA,8BAAe,QAAQ,yBAAR,CAAf,E,CALA;;;AAOA;AACA,uBAAQ,IAAR,CAAa,WAAW;AACpB;AACA,YAAQ,EAAR,CAAW,SAAX,EAAsB;AAAA,eAAM,SAAN;AAAA,KAAtB;AACH,CAHD;;AAMA,IAAI,MAAJ;AACA,QAAQ,EAAR,CAAW,MAAX,EAAmB,QAAQ;AACvB,QAAI,MAAJ,EAAY;AACR,eAAO,IAAP;AACH;AACJ,CAJD;;AAMA,SAAS,KAAT,GAAiB;AACb,aAAS,UAAU,6BAAW,CAC1B,WAD0B,EAE1B,cAF0B,EAG1B,2BAH0B,EAI1B,QAJ0B,EAK1B,uBAAK,SALqB,EAM1B,WAN0B,EAOzB,OAAK,KAAK,GAAL,EAAW,GAPS,CAAX,CAAnB;AASA,WAAO,KAAP;AACH;;AAED,IAAI,eAAJ;;AAEA,SAAS,OAAT,GAAmB;AACf,QAAI,CAAC,MAAL,EAAa,OAAO,OAAP;;AAEb,QAAI,eAAJ,EAAqB,aAAa,eAAb;AACrB,sBAAkB,WAAW,MAAM;AAC/B,eAAO,IAAP,CAAY,OAAO,IAAP,CAAY,MAAZ,GAAqB,CAAjC,IAAuC,OAAK,KAAK,GAAL,EAAW,GAAvD;AACA,eAAO,OAAP;AACH,KAHiB,EAGf,IAHe,CAAlB;AAIH","file":"server.js","sourcesContent":["// const bsReload = require('./bs-reload');\nimport { clean, watch, registerPlugin } from 'pob-babel';\nimport argv from 'minimist-argv';\nimport { node as nodeDaemon } from 'springbokjs-daemon';\n\nregisterPlugin(require('./pob-build-plugins/yml'));\n\nclean();\nwatch().then(emitter => {\n    start();\n    emitter.on('changed', () => restart());\n});\n\n\nlet daemon;\nprocess.on('exit', code => {\n    if (daemon) {\n        daemon.stop();\n    }\n});\n\nfunction start() {\n    daemon = daemon || nodeDaemon([\n        '--harmony',\n        '--es_staging',\n        'lib-node6/index.server.js',\n        '--port',\n        argv.proxyPort,\n        '--version',\n        `dev${Date.now()}`,\n    ]);\n    daemon.start();\n}\n\nlet _restartTimeout;\n\nfunction restart() {\n    if (!daemon) return start();\n\n    if (_restartTimeout) clearTimeout(_restartTimeout);\n    _restartTimeout = setTimeout(() => {\n        daemon.args[daemon.args.length - 1] = `dev${Date.now()}`;\n        daemon.restart();\n    }, 1000);\n}\n"]}