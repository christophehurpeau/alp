{"version":3,"sources":["../src/server.js"],"names":["then","emitter","daemon","proxyPort","Date","now","process","on","stop","start","_restartTimeout","clearTimeout","args","length","restartTimeout"],"mappings":";;AACA;;;;AACA;;AACA;;;;AAEA,0B,CALA;;AAMA,0BAAQA,IAAR,CAAcC,OAAD,IAAa;AACxB,QAAMC,SAAS,6BAAW,CACxB,+BADwB,EAExB,QAFwB,EAGxB,uBAAKC,SAHmB,EAIxB,WAJwB,EAKvB,OAAKC,KAAKC,GAAL,EAAW,GALO,CAAX,CAAf;;AAQAC,UAAQC,EAAR,CAAW,MAAX,EAAmB,MAAM;AACvB,QAAIL,MAAJ,EAAY;AACVA,aAAOM,IAAP;AACD;AACF,GAJD;;AAMAN,SAAOO,KAAP;;AAEA,MAAIC,eAAJ;AACAT,UAAQM,EAAR,CAAW,SAAX,EAAsB,MAAM;AAC1B,QAAIG,eAAJ,EAAqBC,aAAaD,eAAb;AACrBR,WAAOU,IAAP,CAAYV,OAAOU,IAAP,CAAYC,MAAZ,GAAqB,CAAjC,IAAuC,OAAKT,KAAKC,GAAL,EAAW,GAAvD;AACAK,sBAAkBR,OAAOY,cAAP,CAAsB,IAAtB,CAAlB;AACD,GAJD;AAKD,CAvBD","file":"server.js","sourcesContent":["// const bsReload = require('./bs-reload');\nimport argv from 'minimist-argv';\nimport { node as nodeDaemon } from 'springbokjs-daemon/src';\nimport { clean, watch } from './server-build';\n\nclean();\nwatch().then((emitter) => {\n  const daemon = nodeDaemon([\n    'lib-node6-dev/index.server.js',\n    '--port',\n    argv.proxyPort,\n    '--version',\n    `dev${Date.now()}`,\n  ]);\n\n  process.on('exit', () => {\n    if (daemon) {\n      daemon.stop();\n    }\n  });\n\n  daemon.start();\n\n  let _restartTimeout;\n  emitter.on('changed', () => {\n    if (_restartTimeout) clearTimeout(_restartTimeout);\n    daemon.args[daemon.args.length - 1] = `dev${Date.now()}`;\n    _restartTimeout = daemon.restartTimeout(1000);\n  });\n});\n"]}