{"version":3,"file":"build-node-node12-dev.mjs","sources":["../src/webpack/css-module-rules.ts","../src/webpack/createPobpackConfig.ts","../src/webpack/node.ts","../src/build-node.ts"],"sourcesContent":["/* eslint-disable max-lines, complexity */\nimport path from 'path';\nimport type { RuleSetLoader, RuleSetRule } from 'webpack';\n\ntype Target = 'node' | 'modern-browser' | 'browser';\n\nexport interface CreateCssModuleUseOptions {\n  target: Target;\n  extractLoader: RuleSetLoader;\n  global?: boolean;\n  plugins: any[];\n  production: boolean;\n  otherLoaders?: RuleSetLoader[];\n}\n\nexport interface CreateScssModuleUseOptions {\n  target: Target;\n  extractLoader: RuleSetLoader;\n  global?: boolean;\n  plugins: any[];\n  production: boolean;\n  themeFile?: string;\n  otherLoaders?: RuleSetLoader[];\n  includePaths?: string[];\n}\n\nexport interface CreateModuleRulesOptions {\n  target: Target;\n  extractLoader: RuleSetLoader;\n  plugins: any[];\n  production: boolean;\n  themeFile?: string;\n  includePaths?: string[];\n}\n\nexport interface StylesCacheGroups {\n  name: 'styles';\n  test: RegExp;\n  chunks: 'all';\n  enforce: true;\n}\n\ntype CreateCssModuleUseFn = (\n  options: CreateCssModuleUseOptions,\n) => RuleSetLoader[];\ntype CreateScssModuleUseFn = (\n  options: CreateScssModuleUseOptions,\n) => RuleSetLoader[];\ntype CreateModuleRulesFn = (options: CreateModuleRulesOptions) => RuleSetRule[];\n\nconst ExcludesFalsy = (Boolean as any) as <T>(\n  x: T | false | null | undefined,\n) => x is T;\n\nconst resolveLoader = (loader: string): string => require.resolve(loader);\n\nconst cssLoaderOptions = function (\n  importLoaders: number,\n  global: boolean,\n  production: boolean,\n  targetIsNode: boolean,\n): any {\n  return {\n    sourceMap: !production,\n    modules: global\n      ? false\n      : {\n          exportOnlyLocals: targetIsNode,\n          localIdentName:\n            production !== false\n              ? '[hash:base64]'\n              : '[name]__[local]___[hash:base64:5]',\n        },\n    importLoaders,\n  };\n};\n\nexport const createCssModuleUse: CreateCssModuleUseFn = function ({\n  target,\n  extractLoader,\n  global = false,\n  plugins,\n  production,\n  otherLoaders = [],\n}) {\n  if (global && target === 'node') {\n    return [{ loader: resolveLoader('ignore-loader') }];\n  }\n\n  return [\n    target !== 'node' && extractLoader,\n    {\n      loader: resolveLoader('css-loader'),\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n      options: cssLoaderOptions(\n        otherLoaders.length + 1 + (!global && !production ? 1 : 0),\n        global,\n        production,\n        target === 'node',\n      ),\n    },\n    !global &&\n      !production &&\n      target !== 'node' && {\n        loader: resolveLoader('typed-css-modules-loader'),\n        options: { noEmit: true },\n      },\n    {\n      loader: resolveLoader('postcss-loader'),\n      options: {\n        ident: 'postcss',\n        sourceMap: !production,\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n        plugins: () => plugins,\n      },\n    },\n    ...otherLoaders,\n  ].filter(ExcludesFalsy);\n};\n\nconst createScssModuleUse: CreateScssModuleUseFn = function ({\n  target,\n  extractLoader,\n  global = false,\n  plugins,\n  production,\n  themeFile,\n  includePaths = [],\n}) {\n  return createCssModuleUse({\n    target,\n    extractLoader,\n    global,\n    plugins,\n    production,\n    otherLoaders: [\n      {\n        loader: resolveLoader('sass-loader'),\n        options: {\n          sourceMap: !production,\n          prependData: `$env: ${process.env.NODE_ENV as string};${\n            themeFile ? `@import '${path.resolve(themeFile)}';` : ''\n          }`,\n          sassOptions: {\n            outputStyle: production !== false && 'compressed',\n            includePaths,\n          },\n        },\n      },\n    ],\n  });\n};\n\nconst createCssModuleRule = function (\n  options: CreateCssModuleUseOptions,\n): RuleSetRule {\n  return {\n    test: /\\.css$/,\n    sideEffects: true,\n    use: createCssModuleUse(options),\n  };\n};\n\nconst fileExtensions = ['css', 'scss'];\n\nexport const stylesCacheGroups = {\n  name: 'styles',\n  test: new RegExp(`\\\\.+(${[...fileExtensions].join('|')})$`),\n  chunks: 'all',\n  enforce: true,\n};\n\nexport const createModuleRules: CreateModuleRulesFn = function ({\n  target,\n  extractLoader,\n  plugins,\n  production,\n  themeFile,\n  includePaths,\n}) {\n  return [\n    {\n      test: /\\.scss$/,\n      oneOf: [\n        {\n          test: /\\.global\\.scss$/,\n          sideEffects: true,\n          use: createScssModuleUse({\n            target,\n            extractLoader,\n            global: true,\n            plugins,\n            production,\n            themeFile,\n            includePaths,\n          }),\n        },\n        {\n          sideEffects: true,\n          use: createScssModuleUse({\n            target,\n            extractLoader,\n            global: false,\n            plugins,\n            production,\n            themeFile,\n            includePaths,\n          }),\n        },\n      ],\n    },\n\n    createCssModuleRule({\n      target,\n      extractLoader,\n      global: false,\n      plugins,\n      production,\n    }),\n  ];\n};\n","/* eslint-disable @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-unsafe-assignment, complexity, max-lines */\n\nimport fs from 'fs';\nimport path from 'path';\nimport autoprefixer from 'autoprefixer';\nimport CssExtractPlugin from 'extract-css-chunks-webpack-plugin';\nimport OptimizeCssAssetsPlugin from 'optimize-css-assets-webpack-plugin';\nimport type { Options } from 'pobpack-types';\nimport webpack from 'webpack';\nimport { createModuleRules, createCssModuleUse } from './css-module-rules';\n\n// stylesCacheGroups\n\ntype TargetType = 'node' | 'modern-browser' | 'browser';\n\nconst ExcludesFalsy = (Boolean as any) as <T>(\n  x: T | false | null | undefined,\n) => x is T;\n\nexport default function createPobpackConfig(\n  target: TargetType,\n  production = false,\n): Partial<Options> {\n  const pkg = JSON.parse(\n    fs.readFileSync(path.resolve('package.json'), 'utf-8'),\n  );\n  const deps = pkg.dependencies || {};\n  const devdeps = pkg.devDependencies || {};\n\n  const hasAntd = !!deps.antd;\n\n  if (deps.antd) {\n    if (!devdeps.less) {\n      throw new Error('less missing: yarn add --dev less');\n    }\n  }\n\n  return {\n    env: process.env.NODE_ENV,\n    hmr: !production,\n    typescript: true,\n\n    whitelistExternalExtensions: [\n      'png',\n      'jpg',\n      'jpeg',\n      'gif',\n      'svg',\n      'scss',\n      'css',\n    ],\n    includeModules: [],\n\n    paths: {\n      build: target === 'node' ? 'build' : 'public',\n    },\n\n    entries: [\n      {\n        key:\n          target === 'node'\n            ? 'index'\n            : // eslint-disable-next-line unicorn/no-nested-ternary\n            target === 'browser'\n            ? 'es5'\n            : 'modern-browsers',\n        path: target === 'node' ? 'index.server.ts' : 'index.browser.ts',\n      },\n    ],\n\n    resolveLoaderModules: [\n      path.join(__dirname, '../..', 'node_modules'),\n      'node_modules',\n    ],\n\n    babel: {\n      minified: target !== 'node' && production,\n      comments: !(target !== 'node' && production),\n\n      presets: [\n        // add react preset with jsx\n        [\n          require.resolve('@babel/preset-react'),\n          { development: !production, useBuiltIns: true },\n        ],\n        // pob preset: flow, import `src`, export default function name, replacements, exnext features, ...\n        [\n          require.resolve('babel-preset-pob-env'),\n          {\n            resolvePreset: (preset: string): string => require.resolve(preset),\n            production,\n            typescript: true,\n            exportDefaultName: false,\n            optimizations: true,\n            target: target === 'node' ? 'node' : 'browser',\n            version:\n              target === 'node'\n                ? 10.13\n                : // eslint-disable-next-line unicorn/no-nested-ternary\n                target === 'modern-browser'\n                ? 'modern'\n                : undefined,\n            loose: true,\n            modules: false,\n          },\n        ],\n      ],\n      plugins: [\n        require.resolve('babel-plugin-inline-classnames-babel7'),\n        hasAntd && [\n          require.resolve('babel-plugin-import'),\n          {\n            libraryName: 'antd',\n            libraryDirectory: target === 'node' ? 'lib' : 'es',\n            style: target !== 'node',\n          },\n        ],\n      ].filter(ExcludesFalsy),\n    },\n\n    moduleRules: [\n      // SCSS RULE, CSS RULE\n      ...createModuleRules({\n        target,\n        extractLoader: {\n          loader: CssExtractPlugin.loader,\n          options: { hmr: !production && target !== 'node', esModule: true },\n        },\n        production,\n        themeFile: './src/theme.scss',\n        plugins: [autoprefixer],\n        includePaths: [path.resolve('./node_modules')],\n      }),\n\n      // LESS RULE (antd)\n      {\n        test: /\\.less$/,\n        use: createCssModuleUse({\n          global: true,\n          target,\n          extractLoader: {\n            loader: CssExtractPlugin.loader,\n            options: { hmr: !production && target !== 'node', esModule: true },\n          },\n          production,\n          plugins: [autoprefixer],\n          otherLoaders: [\n            {\n              loader: require.resolve('less-loader'),\n              options: {\n                javascriptEnabled: true,\n                // modifyVars: path.resolve('./src/less-modifyVars.js'),\n              },\n            },\n            {\n              loader: require.resolve('less-modify-var-loader'),\n              options: {\n                filePath: path.resolve('./src/theme.less'),\n              },\n            },\n          ],\n        }),\n      },\n\n      // IMG RULE\n      {\n        test: /\\.(png|jpg|jpeg|gif|svg)$/,\n        loader: require.resolve('url-loader'),\n        options: {\n          /* config to emit with node doesn't work anymore because css is ignored by node */\n          // emitFile: target === 'node', // only write file if node\n          // outputPath: '../public/', // because it's node who is writing the file, node is in build/\n          // publicPath: (url: string): string => url.replace(/^..\\/public\\//, ''),\n          emitFile: target === 'modern-browser',\n          limit: 1000,\n          name: 'images/[hash].[ext]',\n        },\n      },\n    ],\n\n    // TODO https://github.com/zeit/next.js/blob/7d78c3b64185d6d6417f1af9cde4a69d32b18cc6/packages/next/build/webpack.js\n    // optimization: {\n    //   minimizer:\n    //     target === 'browser' ? [new OptimizeCssAssetsPlugin()] : undefined,\n    //   splitChunks: {\n    //     cacheGroups: {\n    //       styles: stylesCacheGroups,\n    //     },\n    //   },\n    // },\n\n    plugins: [\n      new CssExtractPlugin({\n        // disable: target === 'node',\n        filename: `${\n          target === 'node'\n            ? 'server'\n            : // eslint-disable-next-line unicorn/no-nested-ternary\n            target === 'browser'\n            ? 'es5'\n            : 'modern-browsers'\n        }.css`,\n      }),\n      new OptimizeCssAssetsPlugin(),\n\n      process.send &&\n        new webpack.ProgressPlugin(\n          (percentage: number, message: string): void => {\n            (process.send as NonNullable<typeof process.send>)({\n              type: 'webpack-progress',\n              percentage,\n              message,\n            });\n          },\n        ),\n\n      // target === 'browser' &&\n      // target !== 'node' &&\n      //   production &&\n      //   new optimize.UglifyJsPlugin({\n      //     compress: {\n      //       warnings: false,\n      //     },\n      //     sourcleMap: !production,\n      //   }),!== 'node' &&\n      //   production &&\n      //   new optimize.UglifyJsPlugin({\n      //     compress: {\n      //       warnings: false,\n      //     },\n      //     sourceMap: !production,\n      //   }),\n      // TODO https://github.com/NekR/offline-plugin\n    ].filter(ExcludesFalsy),\n  };\n}\n","import path from 'path';\nimport { createAppNodeCompiler, watchAndRunCompiler } from 'pobpack-node';\nimport type { PobpackCompiler } from 'pobpack-types';\nimport type { Watching } from 'webpack';\nimport createPobpackConfig from './createPobpackConfig';\n\nexport const createNodeCompiler = (production: boolean): PobpackCompiler =>\n  createAppNodeCompiler(createPobpackConfig('node', production), {\n    progressBar: false,\n  });\n\nexport const watchAndRun = (\n  nodeCompiler: PobpackCompiler,\n  port: string | number,\n): Watching =>\n  watchAndRunCompiler(nodeCompiler, {\n    key: 'alp-dev:node:watchAndRun',\n    displayName: 'node:watchAndRun',\n    args: ['--trace-warnings', '--port', port, '--version', Date.now()],\n    cwd: path.resolve('.'),\n  });\n","import { createNodeCompiler } from './webpack/node';\n\nconst nodeCompiler = createNodeCompiler(process.env.NODE_ENV === 'production');\n\n// eslint-disable-next-line @typescript-eslint/no-floating-promises\nnodeCompiler.run();\n"],"names":["ExcludesFalsy","Boolean","resolveLoader","loader","require","resolve","cssLoaderOptions","importLoaders","global","production","targetIsNode","sourceMap","modules","exportOnlyLocals","localIdentName","createCssModuleUse","target","extractLoader","plugins","otherLoaders","options","length","noEmit","ident","filter","createScssModuleUse","themeFile","includePaths","prependData","process","env","NODE_ENV","path","sassOptions","outputStyle","createCssModuleRule","test","sideEffects","use","createModuleRules","oneOf","createPobpackConfig","pkg","JSON","parse","fs","readFileSync","deps","dependencies","devdeps","devDependencies","hasAntd","antd","less","Error","hmr","typescript","whitelistExternalExtensions","includeModules","paths","build","entries","key","resolveLoaderModules","join","__dirname","babel","minified","comments","presets","development","useBuiltIns","resolvePreset","preset","exportDefaultName","optimizations","version","undefined","loose","libraryName","libraryDirectory","style","moduleRules","CssExtractPlugin","esModule","autoprefixer","javascriptEnabled","filePath","emitFile","limit","name","filename","OptimizeCssAssetsPlugin","send","webpack","ProgressPlugin","percentage","message","type","createNodeCompiler","createAppNodeCompiler","progressBar","nodeCompiler","run"],"mappings":"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"}