{"version":3,"file":"index-browser.cjs.js","sources":["../src/index.ts"],"sourcesContent":["import type { BrowserApplicationInCreation } from 'alp-types';\n\ndeclare module 'alp-types' {\n  interface BaseContext {\n    firstAcceptedLanguage: string;\n    language: string;\n  }\n  interface Context {}\n}\n\nexport default function alpLanguage(app: BrowserApplicationInCreation): void {\n  const config = app.context.config;\n  const availableLanguages = config.get<string[] | undefined>(\n    'availableLanguages',\n  );\n  if (!availableLanguages) {\n    throw new Error('Missing config \"availableLanguages\"');\n  }\n\n  app.context.firstAcceptedLanguage =\n    navigator.languages[0] || availableLanguages[0];\n\n  const languageFound = navigator.languages.some((language) => {\n    const languageCode = language.split('-')[0].toLowerCase();\n    if (availableLanguages.includes(languageCode)) {\n      app.context.language = languageCode;\n      return true;\n    }\n\n    return false;\n  });\n\n  if (!languageFound) {\n    app.context.language = availableLanguages[0];\n  }\n}\n"],"names":["alpLanguage","app","config","context","availableLanguages","get","Error","firstAcceptedLanguage","navigator","languages","languageFound","some","language","languageCode","split","toLowerCase","includes"],"mappings":";;;;AAUe,SAASA,WAAT,CAAqBC,GAArB,EAA8D;AAC3E,MAAMC,MAAM,GAAGD,GAAG,CAACE,OAAJ,CAAYD,MAA3B;AACA,MAAME,kBAAkB,GAAGF,MAAM,CAACG,GAAP,CACzB,oBADyB,CAA3B;;AAGA,MAAI,CAACD,kBAAL,EAAyB;AACvB,UAAM,IAAIE,KAAJ,CAAU,qCAAV,CAAN;AACD;;AAEDL,EAAAA,GAAG,CAACE,OAAJ,CAAYI,qBAAZ,GACEC,SAAS,CAACC,SAAV,CAAoB,CAApB,KAA0BL,kBAAkB,CAAC,CAAD,CAD9C;AAGA,MAAMM,aAAa,GAAGF,SAAS,CAACC,SAAV,CAAoBE,IAApB,CAAyB,UAACC,QAAD,EAAc;AAC3D,QAAMC,YAAY,GAAGD,QAAQ,CAACE,KAAT,CAAe,GAAf,EAAoB,CAApB,EAAuBC,WAAvB,EAArB;;AACA,QAAIX,kBAAkB,CAACY,QAAnB,CAA4BH,YAA5B,CAAJ,EAA+C;AAC7CZ,MAAAA,GAAG,CAACE,OAAJ,CAAYS,QAAZ,GAAuBC,YAAvB;AACA,aAAO,IAAP;AACD;;AAED,WAAO,KAAP;AACD,GARqB,CAAtB;;AAUA,MAAI,CAACH,aAAL,EAAoB;AAClBT,IAAAA,GAAG,CAACE,OAAJ,CAAYS,QAAZ,GAAuBR,kBAAkB,CAAC,CAAD,CAAzC;AACD;AACF;;;;"}