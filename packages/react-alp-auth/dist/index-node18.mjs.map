{"version":3,"file":"index-node18.mjs","sources":["../src/index.tsx"],"sourcesContent":["import { POB_TARGET } from 'pob-babel';\nimport type { GetServerSidePropsContext } from 'alp-nextjs';\nimport { getServerCookieValue } from 'alp-nextjs';\nimport BrowserCookies from 'js-cookie';\n\nconst COOKIE_NAME_STATE = 'loggedInUserState';\n\ninterface AuthStateValue {\n  loggedInUserId: string;\n  expiresIn: number;\n}\n\nconst parseCookie = (stateValue?: string): AuthStateValue | null => {\n  return stateValue ? (JSON.parse(stateValue) as AuthStateValue) : null;\n};\n\ninterface LoggedInUserState {\n  isLoggedIn: boolean;\n  loggedInUserId: string | undefined;\n  expiresIn: number | undefined;\n}\n\nconst browserStateValueParsed = parseCookie(\n  BrowserCookies.get(COOKIE_NAME_STATE),\n);\n\nfunction useLoggedInUserStateBrowser(): LoggedInUserState {\n  return {\n    isLoggedIn: !!browserStateValueParsed,\n    loggedInUserId: browserStateValueParsed?.loggedInUserId,\n    expiresIn: browserStateValueParsed?.expiresIn,\n  };\n}\n\nfunction useLoggedInUserStateServer(\n  serverCookieValue?: string | null,\n): LoggedInUserState {\n  if (serverCookieValue) {\n    const serverStateValueParsed = parseCookie(serverCookieValue);\n    return {\n      isLoggedIn: !!serverStateValueParsed,\n      loggedInUserId: serverStateValueParsed?.loggedInUserId,\n      expiresIn: serverStateValueParsed?.expiresIn,\n    };\n  }\n  return {\n    isLoggedIn: false,\n    loggedInUserId: undefined,\n    expiresIn: undefined,\n  };\n}\n\nexport const useLoggedInUserState =\n  POB_TARGET === 'node'\n    ? useLoggedInUserStateServer\n    : useLoggedInUserStateBrowser;\n\nexport const getServerAuthCookieValue = (\n  ctx: GetServerSidePropsContext,\n): string | null => getServerCookieValue(ctx, COOKIE_NAME_STATE);\n"],"names":["COOKIE_NAME_STATE","parseCookie","stateValue","JSON","parse","BrowserCookies","get","useLoggedInUserStateServer","serverCookieValue","serverStateValueParsed","isLoggedIn","loggedInUserId","expiresIn","undefined","useLoggedInUserState","getServerAuthCookieValue","ctx","getServerCookieValue"],"mappings":";;;AAKA,MAAMA,iBAAiB,GAAG,mBAAmB,CAAA;AAO7C,MAAMC,WAAW,GAAIC,UAAmB,IAA4B;EAClE,OAAOA,UAAU,GAAIC,IAAI,CAACC,KAAK,CAACF,UAAU,CAAC,GAAsB,IAAI,CAAA;AACvE,CAAC,CAAA;AAQ+BD,WAAW,CACzCI,cAAc,CAACC,GAAG,CAAkB,mBAAA,CACtC,EAAC;AAUD,SAASC,0BAA0BA,CACjCC,iBAAiC,EACd;AACnB,EAAA,IAAIA,iBAAiB,EAAE;AACrB,IAAA,MAAMC,sBAAsB,GAAGR,WAAW,CAACO,iBAAiB,CAAC,CAAA;IAC7D,OAAO;MACLE,UAAU,EAAE,CAAC,CAACD,sBAAsB;MACpCE,cAAc,EAAEF,sBAAsB,EAAEE,cAAc;MACtDC,SAAS,EAAEH,sBAAsB,EAAEG,SAAAA;KACpC,CAAA;AACH,GAAA;EACA,OAAO;AACLF,IAAAA,UAAU,EAAE,KAAK;AACjBC,IAAAA,cAAc,EAAEE,SAAS;AACzBD,IAAAA,SAAS,EAAEC,SAAAA;GACZ,CAAA;AACH,CAAA;AAEO,MAAMC,oBAAoB,GAE3BP,2BAC2B;AAE1B,MAAMQ,wBAAwB,GACnCC,GAA8B,IACZC,oBAAoB,CAACD,GAAG,EAAEhB,iBAAiB;;;;"}