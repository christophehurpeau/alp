{"version":3,"sources":["../src/index.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAYqB,MAAN,MAAM,GAAN,uBAAsB;;;;;;AAMjC,kBAAmD;YAAvC,gEAAU,QAAQ,GAAR,kBAA6B;YAAd,gEAAU,kBAAI;;AAC/C,gBAD+C;AAE/C,aAAK,OAAL,GAAe,OAAf,CAF+C;AAG/C,cAAM,gBAAgB,QAAQ,CAAC,GAAE,OAAH,EAAW,gBAAX,CAAR,CAAhB,CAHyC;AAI/C,iCAAO,CAAC,GAAE,KAAK,OAAL,EAAa,OAAhB,CAAP,EAAiC;AAC7B,yBAD6B;AAE7B,kBAAM,QAAQ,IAAR;SAFV,EAGG,IAHH,EAJ+C;AAQ/C,iCAAO,IAAP,EAR+C;AAS/C,mCAAS,IAAT,EAT+C;AAU/C,iCAAO,IAAP,EAV+C;AAW/C,oCAAU,SAAV,EAAqB,IAArB,EAX+C;KAAnD;;;;MAcA,IAAI,WAAJ,GAAkB;AACd,eAAO,KAAK,GAAL,CADO;KAAlB;;;;;MAIA,aAAa,aAAb,EAA4B,WAA5B,EAAyC;AACrC,eAAO,yBAAO,aAAP,EAAsB,WAAtB,EAAmC,IAAnC,CAAP,CADqC;KAAzC;;AAIA,kBAAc;AACV,aAAK,GAAL,CAAS,0BAAQ,yBAAM,CAAC,GAAE,KAAK,OAAL,EAAa,WAAhB,CAAN,CAAR,CAAT;AADU,KAAd;;AAIA,kBAAc;AACV,aAAK,GAAL,sBADU;KAAd;;;;;MAIA,UAAU,aAAV,EAAyB,WAAzB,EAAsC;AAClC,wBAAgB,iBAAiB,QAAQ,CAAC,GAAE,KAAK,OAAL,EAAa,cAAhB,CAAR,CAAjB,CADkB;AAElC,sBAAc,eAAe,QAAQ,CAAC,GAAE,KAAK,OAAL,EAAa,YAAhB,CAAR,CAAf,CAFoB;AAGlC,aAAK,GAAL,CAAS,KAAK,YAAL,CAAkB,aAAlB,EAAiC,WAAjC,CAAT,EAHkC;KAAtC;;AAMA,aAAS;AACL,eAAO,yBAAQ,CAAC,GAAE,KAAK,OAAL,EAAa,eAAhB,CAAR,EAA0C,IAA1C,EACF,KADE,CACI,OAAO;AACV,iBAAK,MAAL,CAAY,KAAZ,CAAkB,GAAlB,EADU;AAEV,kBAAM,GAAN,CAFU;SAAP,CADX,CADK;KAAT;CA1CW;kBAAM","file":"index.js","sourcesContent":["import Koa from 'koa';\nimport serve from 'koa-static';\nimport convert from 'koa-convert';\nimport config from 'auk-config';\nimport errors from 'auk-errors';\nimport params from 'auk-params';\nimport language from 'auk-language';\nimport logger from 'auk-logger';\nimport translate from 'auk-translate';\nimport router from 'auk-limosa';\nimport _listen from 'auk-listen';\n\nexport default class Auk extends Koa {\n    /**\n     * @param {string} [dirname] directory of the application (lib/) or `process.cwd()`\n     * @param {Object} [options] directory of the application (lib/) or `process.cwd()`\n     * @param {array} [options.argv] list of overridable config by argv\n     */\n    constructor(dirname = process.cwd(), options = {}) {\n        super();\n        this.dirname = dirname;\n        const packageConfig = require(`${dirname}/../package.json`);\n        config(`${this.dirname}/config`, {\n            packageConfig,\n            argv: options.argv,\n        })(this);\n        params(this);\n        language(this);\n        logger(this);\n        translate('locales')(this);\n    }\n\n    get environment() {\n        return this.env;\n    }\n\n    createRouter(routerBuilder, controllers) {\n        return router(routerBuilder, controllers)(this);\n    }\n\n    servePublic() {\n        this.use(convert(serve(`${this.dirname}/../public/`))); // static files\n    }\n\n    catchErrors() {\n        this.use(errors);\n    }\n\n    useRouter(routerBuilder, controllers) {\n        routerBuilder = routerBuilder || require(`${this.dirname}/routerBuilder`);\n        controllers = controllers || require(`${this.dirname}/controllers`);\n        this.use(this.createRouter(routerBuilder, controllers));\n    }\n\n    listen() {\n        return _listen(`${this.dirname}/../config/cert`)(this)\n            .catch(err => {\n                this.logger.error(err);\n                throw err;\n            });\n    }\n}\n"]}