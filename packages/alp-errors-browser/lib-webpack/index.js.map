{"version":3,"sources":["../src/index.js"],"names":[],"mappings":";;AAAA,SAAS,SAAS,UAAlB,QAAoC,UAApC;AACA;AACA,OAAO,MAAP,MAAmB,oBAAnB;;AAEA,IAAM,SAAS,IAAI,MAAJ,CAAW,YAAX,CAAf;AACA;;AAEA;AAAA,yDAAe,iBAAgB,GAAhB,EAAqB,IAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BAED,MAFC;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAIP,4BAAI,MAAJ,GAAa,YAAI,MAAJ,IAAc,GAA3B;;AAJO,8BAMH,QAAQ,GAAR,CAAY,QAAZ,KAAyB,YANtB;AAAA;AAAA;AAAA;;AAOG,mCAPH,GAOiB,uBAPjB;;AAQH,+BAAO,KAAP,CAAa,WAAb;AACA;AACA,4BAAI,IAAJ,GAAW,YAAY,KAAvB;AAVG;AAAA;;AAAA;AAYH,+BAAO,KAAP;;AAZG,6BAaC,YAAI,MAbL;AAAA;AAAA;AAAA;;AAcC,4BAAI,IAAJ,GAAW,YAAI,OAAf;AAdD;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAf;;AAAA;AAAA;AAAA;AAAA","file":"index.js","sourcesContent":["import { parse as parseError } from 'alouette';\n// import ErrorHtmlRenderer from 'alouette/lib/HtmlRenderer';\nimport Logger from 'nightingale-logger';\n\nconst logger = new Logger('alp.errors');\n// const errorHtmlRenderer = new ErrorHtmlRenderer();\n\nexport default async function (ctx, next) {\n    try {\n        await next();\n    } catch (err) {\n        ctx.status = err.status || 500;\n\n        if (process.env.NODE_ENV !== 'production') {\n            const parsedError = parseError(err);\n            logger.error(parsedError);\n            // ctx.body = errorHtmlRenderer.render(parsedError);\n            ctx.body = parsedError.stack;\n        } else {\n            logger.error(err);\n            if (err.expose) {\n                ctx.body = err.message;\n            } else {\n                throw err;\n            }\n        }\n    }\n}\n"]}